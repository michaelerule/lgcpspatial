<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lgcpspatial.plot &mdash; Fast Log-Gaussian Point-Process Methods for Grid Cells 5 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" src="../../_static/jquery.js"></script>
        <script integrity="sha384-lSZeSIVKp9myfKbDQ3GkN/KHjUc+mzg17VKDN4Y2kUeBSJioB9QSM639vM9fuY//" src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Fast Log-Gaussian Point-Process Methods for Grid Cells
              <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorial notebooks:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../example%200%20hyperparameter%20groundtruth%20test.html">Example 0: Ground truth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example%201%20load%20data.html">Example 1: Load data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example%202%20heuristic%20parameter%20lgcp%20infer.html">Example 2: Heuristic hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example%203%20optimize%20hyperparameters.html">Example 3: Optimized hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example%204%20confidence%20intervals.html">Example 4: Confidence intervals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example%205%20heading%20dependence.html">Example 5: Heading dependence</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules in the lgcpspatial package:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.lgcp2d.html">lgcp2d</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.simulate.html">simulate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.loaddata.html">loaddata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.gridsearch.html">gridsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.hyperparameters.html">hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.posterior.html">posterior</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.heading.html">heading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.estimators.html">estimators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.util.html">util</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lgcpspatial.plot.html">plot</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Fast Log-Gaussian Point-Process Methods for Grid Cells</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">lgcpspatial.plot</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for lgcpspatial.plot</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding: UTF-8 -*-</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">plot.py: A subset of plotting helpers copied from </span>
<span class="sd">``neurotools/graphics/plot``, and some new helper routines to reduce </span>
<span class="sd">notebook clutter</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span>             <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>        <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span>
<span class="kn">from</span> <span class="nn">scipy.spatial</span>  <span class="kn">import</span> <span class="n">ConvexHull</span>
<span class="kn">from</span> <span class="nn">.util</span> <span class="kn">import</span> <span class="n">c2p</span><span class="p">,</span><span class="n">p2c</span>

<span class="n">SMALL</span>  <span class="o">=</span> <span class="mi">7</span>
<span class="n">MEDIUM</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">BIGGER</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">LARGE</span>  <span class="o">=</span> <span class="n">BIGGER</span>
<span class="c1"># │ Fonts</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="mi">240</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.origin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.cmap&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="s1">&#39;magma&#39;</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span>           <span class="p">]</span><span class="o">=</span><span class="n">SMALL</span>  <span class="c1"># │ controls default text sizes</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span>      <span class="p">]</span><span class="o">=</span><span class="n">MEDIUM</span> <span class="c1"># │ fontsize of the axes title</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span>      <span class="p">]</span><span class="o">=</span><span class="n">MEDIUM</span> <span class="c1"># │ fontsize of the x and y labels</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.labelsize&#39;</span>     <span class="p">]</span><span class="o">=</span><span class="n">SMALL</span>  <span class="c1"># │ fontsize of the tick labels</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.labelsize&#39;</span>     <span class="p">]</span><span class="o">=</span><span class="n">SMALL</span>  <span class="c1"># │ fontsize of the tick labels</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span>     <span class="p">]</span><span class="o">=</span><span class="n">SMALL</span>  <span class="c1"># │ legend fontsize</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.titlesize&#39;</span>    <span class="p">]</span><span class="o">=</span><span class="n">BIGGER</span> <span class="c1"># │ fontsize of the figure title</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.solid_capstyle&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;round&#39;</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span>         <span class="p">]</span><span class="o">=</span><span class="mi">140</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span>          <span class="p">]</span><span class="o">=</span><span class="mi">140</span>
<span class="n">lw</span> <span class="o">=</span> <span class="mf">.7</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lw</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.major.width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lw</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.minor.width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lw</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.major.width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lw</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.minor.width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lw</span>
<span class="n">tl</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.major.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.minor.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.major.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.minor.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tl</span>


<span class="c1"># Some custom colors, just for fun! </span>
<span class="n">WHITE</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#f1f0e9&#39;</span><span class="p">))</span>
<span class="n">RUST</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#eb7a59&#39;</span><span class="p">))</span>
<span class="n">OCHRE</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#eea300&#39;</span><span class="p">))</span>
<span class="n">AZURE</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#5aa0df&#39;</span><span class="p">))</span>
<span class="n">TURQUOISE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#00bac9&#39;</span><span class="p">))</span>
<span class="n">TEAL</span>       <span class="o">=</span> <span class="n">TURQUOISE</span>
<span class="n">BLACK</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#44525c&#39;</span><span class="p">))</span>
<span class="n">YELLOW</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#efcd2b&#39;</span><span class="p">))</span>
<span class="n">INDIGO</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#606ec3&#39;</span><span class="p">))</span>
<span class="n">VIOLET</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#8d5ccd&#39;</span><span class="p">))</span>
<span class="n">MAUVE</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#b56ab6&#39;</span><span class="p">))</span>
<span class="n">MAGENTA</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#cc79a7&#39;</span><span class="p">))</span>
<span class="n">CHARTREUSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#b59f1a&#39;</span><span class="p">))</span>
<span class="n">MOSS</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#77ae64&#39;</span><span class="p">))</span>
<span class="n">VIRIDIAN</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#11be8d&#39;</span><span class="p">))</span>
<span class="n">CRIMSON</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#b41d4d&#39;</span><span class="p">))</span>
<span class="n">GOLD</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#ffd92e&#39;</span><span class="p">))</span>
<span class="n">TAN</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#765931&#39;</span><span class="p">))</span>
<span class="n">SALMON</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#fa8c61&#39;</span><span class="p">))</span>
<span class="n">GRAY</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#b3b3b3&#39;</span><span class="p">))</span>
<span class="n">LICHEN</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="s1">&#39;#63c2a3&#39;</span><span class="p">))</span>
<span class="n">RUTTEN</span>  <span class="o">=</span> <span class="p">[</span><span class="n">GOLD</span><span class="p">,</span><span class="n">TAN</span><span class="p">,</span><span class="n">SALMON</span><span class="p">,</span><span class="n">GRAY</span><span class="p">,</span><span class="n">LICHEN</span><span class="p">]</span>
<span class="n">GATHER</span>  <span class="o">=</span> <span class="p">[</span><span class="n">WHITE</span><span class="p">,</span><span class="n">RUST</span><span class="p">,</span><span class="n">OCHRE</span><span class="p">,</span><span class="n">AZURE</span><span class="p">,</span><span class="n">TURQUOISE</span><span class="p">,</span><span class="n">BLACK</span><span class="p">]</span>
<span class="n">COLORS</span>  <span class="o">=</span> <span class="p">[</span><span class="n">BLACK</span><span class="p">,</span><span class="n">WHITE</span><span class="p">,</span><span class="n">YELLOW</span><span class="p">,</span><span class="n">OCHRE</span><span class="p">,</span><span class="n">CHARTREUSE</span><span class="p">,</span><span class="n">MOSS</span><span class="p">,</span><span class="n">VIRIDIAN</span><span class="p">,</span>
    <span class="n">TURQUOISE</span><span class="p">,</span><span class="n">AZURE</span><span class="p">,</span><span class="n">INDIGO</span><span class="p">,</span><span class="n">VIOLET</span><span class="p">,</span><span class="n">MAUVE</span><span class="p">,</span><span class="n">MAGENTA</span><span class="p">,</span><span class="n">RUST</span><span class="p">]</span>
<span class="n">CYCLE</span>   <span class="o">=</span> <span class="p">[</span><span class="n">BLACK</span><span class="p">,</span><span class="n">RUST</span><span class="p">,</span><span class="n">TURQUOISE</span><span class="p">,</span><span class="n">OCHRE</span><span class="p">,</span><span class="n">AZURE</span><span class="p">,</span><span class="n">MAUVE</span><span class="p">,</span><span class="n">YELLOW</span><span class="p">,</span><span class="n">INDIGO</span><span class="p">]</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">CYCLE</span><span class="p">)</span>
    

<div class="viewcode-block" id="simpleaxis"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.simpleaxis">[docs]</a><span class="k">def</span> <span class="nf">simpleaxis</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Only draw the bottom and left axis lines</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : optional, defaults to plt.gca() if None</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="rightaxis"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.rightaxis">[docs]</a><span class="k">def</span> <span class="nf">rightaxis</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Only draw the bottom and right axis lines.</span>
<span class="sd">    Move y axis to the right.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : optional, defaults to plt.gca() if None</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="simpleraxis"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.simpleraxis">[docs]</a><span class="k">def</span> <span class="nf">simpleraxis</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Only draw the left y axis, nothing else</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : optiona, defaults to plt.gca() if None</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="simpleraxis2"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.simpleraxis2">[docs]</a><span class="k">def</span> <span class="nf">simpleraxis2</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Only draw the left y axis, nothing else</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : optiona, defaults to plt.gca() if None</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="noaxis"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.noaxis">[docs]</a><span class="k">def</span> <span class="nf">noaxis</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Hide all axes</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : optiona, defaults to plt.gca() if None</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span></div>


<div class="viewcode-block" id="axeson"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.axeson">[docs]</a><span class="k">def</span> <span class="nf">axeson</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="nox"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.nox">[docs]</a><span class="k">def</span> <span class="nf">nox</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Hide x-axis</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="noy"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.noy">[docs]</a><span class="k">def</span> <span class="nf">noy</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Hide y-axis</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="noxyaxes"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.noxyaxes">[docs]</a><span class="k">def</span> <span class="nf">noxyaxes</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Hide all aspects of x and y axes. </span>
<span class="sd">    See ``nox``, ``noy``, and ``noaxis``</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">nox</span><span class="p">()</span>
    <span class="n">noy</span><span class="p">()</span>
    <span class="n">noaxis</span><span class="p">()</span></div>


<div class="viewcode-block" id="figurebox"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.figurebox">[docs]</a><span class="k">def</span> <span class="nf">figurebox</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)):</span>
    <span class="c1"># new clear axis overlay with 0-1 limits</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span><span class="p">,</span> <span class="n">lines</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="c1"># axisbg=(1,1,1,0))</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([]);</span> <span class="n">noxyaxes</span><span class="p">()</span></div>


<div class="viewcode-block" id="pixels_to_xfigureunits"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.pixels_to_xfigureunits">[docs]</a><span class="k">def</span> <span class="nf">pixels_to_xfigureunits</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Converts a measurement in pixels to units of the current</span>
<span class="sd">    figure width scale</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span>  <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">w_pixels</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">fig</span><span class="o">.</span><span class="n">dpi</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">w_pixels</span><span class="p">)</span></div>


<div class="viewcode-block" id="pixels_to_yfigureunits"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.pixels_to_yfigureunits">[docs]</a><span class="k">def</span> <span class="nf">pixels_to_yfigureunits</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Converts a measurement in pixels to units of the current</span>
<span class="sd">    figure height scale</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span>  <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">h_pixels</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">fig</span><span class="o">.</span><span class="n">dpi</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">h_pixels</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="nudge_axis_left"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.nudge_axis_left">[docs]</a><span class="k">def</span> <span class="nf">nudge_axis_left</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Moves the left x-axis limit, keeping the right limit intact. </span>
<span class="sd">    This changes the width of the plot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dx : number</span>
<span class="sd">        Amount (in pixels) to adjust axis</span>
<span class="sd">    ax : axis, default None</span>
<span class="sd">        If None, uses gca()</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">height</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">pixels_to_xfigureunits</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">h</span><span class="p">))</span></div>
    

<div class="viewcode-block" id="nudge_axis_right"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.nudge_axis_right">[docs]</a><span class="k">def</span> <span class="nf">nudge_axis_right</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Moves the right x-axis limit, keeping the left limit intact. </span>
<span class="sd">    This changes the width of the plot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dx : number</span>
<span class="sd">        Amount (in pixels) to adjust axis</span>
<span class="sd">    ax : axis, default None</span>
<span class="sd">        If None, uses gca()</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">height</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">pixels_to_xfigureunits</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">h</span><span class="p">))</span></div>
    

<div class="viewcode-block" id="nudge_axis_x"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.nudge_axis_x">[docs]</a><span class="k">def</span> <span class="nf">nudge_axis_x</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This does not change the width of the axis</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dx : number</span>
<span class="sd">        Amount (in pixels) to adjust axis</span>
<span class="sd">    ax : axis, default None</span>
<span class="sd">        If None, uses gca()</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">height</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">pixels_to_xfigureunits</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">))</span></div>
    

<div class="viewcode-block" id="nudge_axis_y_pixels"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.nudge_axis_y_pixels">[docs]</a><span class="k">def</span> <span class="nf">nudge_axis_y_pixels</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    moves axis dy pixels.</span>
<span class="sd">    Direction of dy may depend on axis orientation.</span>
<span class="sd">    Does not change axis height.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">height</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="n">pixels_to_yfigureunits</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">dy</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">))</span></div>
    

<div class="viewcode-block" id="adjust_axis_height_pixels"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.adjust_axis_height_pixels">[docs]</a><span class="k">def</span> <span class="nf">adjust_axis_height_pixels</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    resize axis by dy pixels.</span>
<span class="sd">    Direction of dy may depends on axis orientation.</span>
<span class="sd">    Does not change the baseline position of axis.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">height</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="o">-</span><span class="n">pixels_to_yfigureunits</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span><span class="n">ax</span><span class="p">)))</span></div>
    

<div class="viewcode-block" id="get_ax_size"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.get_ax_size">[docs]</a><span class="k">def</span> <span class="nf">get_ax_size</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Gets tha axis size in figure-relative units</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">fig</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">ax</span>   <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
    <span class="n">width</span>  <span class="o">*=</span> <span class="n">fig</span><span class="o">.</span><span class="n">dpi</span>
    <span class="n">height</span> <span class="o">*=</span> <span class="n">fig</span><span class="o">.</span><span class="n">dpi</span>
    <span class="k">return</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span></div>


<div class="viewcode-block" id="yunits_to_pixels"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.yunits_to_pixels">[docs]</a><span class="k">def</span> <span class="nf">yunits_to_pixels</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Converts a measurement in units of the current y-axis to pixels</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span>  <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">get_ax_size</span><span class="p">()</span>
    <span class="n">dy</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="n">dy</span></div>


<div class="viewcode-block" id="xunits_to_pixels"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.xunits_to_pixels">[docs]</a><span class="k">def</span> <span class="nf">xunits_to_pixels</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Converts a measurement in units of the current x-axis to pixels</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span>  <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">get_ax_size</span><span class="p">()</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">xlim</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span></div>
    

<div class="viewcode-block" id="yscalebar"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.yscalebar">[docs]</a><span class="k">def</span> <span class="nf">yscalebar</span><span class="p">(</span><span class="n">ycenter</span><span class="p">,</span><span class="n">yheight</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Add vertical scale bar to plot</span>
<span class="sd">    </span>
<span class="sd">    Other Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : axis, if None (default), uses the current axis.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">yspan</span> <span class="o">=</span> <span class="p">[</span><span class="n">ycenter</span><span class="o">-</span><span class="n">yheight</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span><span class="n">ycenter</span><span class="o">+</span><span class="n">yheight</span><span class="o">/</span><span class="mf">2.0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span> <span class="c1"># enforce packing of geometry</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">pixels_to_xunits</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">xl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="n">yl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span><span class="n">yspan</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">side</span><span class="o">==</span><span class="s1">&#39;left&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">pixels_to_xunits</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yspan</span><span class="p">),</span><span class="n">label</span><span class="p">,</span>
            <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">pixels_to_xunits</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yspan</span><span class="p">),</span><span class="n">label</span><span class="p">,</span>
            <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xl</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">yl</span><span class="p">)</span></div>


<div class="viewcode-block" id="xscalebar"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.xscalebar">[docs]</a><span class="k">def</span> <span class="nf">xscalebar</span><span class="p">(</span><span class="n">xcenter</span><span class="p">,</span><span class="n">xlength</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Add horizontal scale bar to plot</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xcenter: float</span>
<span class="sd">        Horizontal center of the scale bar</span>
<span class="sd">    xlength: float</span>
<span class="sd">        How wide the scale bar is</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">xspan</span> <span class="o">=</span> <span class="p">[</span><span class="n">xcenter</span><span class="o">-</span><span class="n">xlength</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span><span class="n">xcenter</span><span class="o">+</span><span class="n">xlength</span><span class="o">/</span><span class="mf">2.0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span> <span class="c1"># enforce packing of geometry</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">pixels_to_yunits</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">yl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">xl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xspan</span><span class="p">,[</span><span class="n">y</span><span class="p">,</span><span class="n">y</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xspan</span><span class="p">),</span><span class="n">y</span><span class="o">-</span><span class="n">pixels_to_yunits</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">label</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
        <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">yl</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xl</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="arrow_between"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.arrow_between">[docs]</a><span class="k">def</span> <span class="nf">arrow_between</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Draw a solid arrow between two axes    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">draw</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>

    <span class="n">position</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>
    <span class="n">ax0</span><span class="p">,</span><span class="n">ay0</span><span class="p">,</span><span class="n">ax1</span><span class="p">,</span><span class="n">ay1</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span><span class="n">position</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="n">position</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span><span class="n">position</span><span class="o">.</span><span class="n">y1</span>
    <span class="n">position</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>
    <span class="n">bx0</span><span class="p">,</span><span class="n">by0</span><span class="p">,</span><span class="n">bx1</span><span class="p">,</span><span class="n">by1</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span><span class="n">position</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="n">position</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span><span class="n">position</span><span class="o">.</span><span class="n">y1</span>

    <span class="c1"># arrow outline</span>
    <span class="n">cx</span>  <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">cy</span>  <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">cx</span> <span class="o">-=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cx</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">cx</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">cy</span> <span class="o">-=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cy</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">cy</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">cwidth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cx</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">cx</span><span class="p">)</span>

    <span class="n">horizontal</span> <span class="o">=</span> <span class="n">vertical</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span>   <span class="nb">max</span><span class="p">(</span><span class="n">ax0</span><span class="p">,</span><span class="n">ax1</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">min</span><span class="p">(</span><span class="n">bx0</span><span class="p">,</span><span class="n">bx1</span><span class="p">):</span> <span class="n">horizontal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># axis A is to the left of axis B</span>
    <span class="k">elif</span> <span class="nb">max</span><span class="p">(</span><span class="n">bx0</span><span class="p">,</span><span class="n">bx1</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">min</span><span class="p">(</span><span class="n">ax0</span><span class="p">,</span><span class="n">ax1</span><span class="p">):</span> <span class="n">horizontal</span> <span class="o">=</span>  <span class="mi">1</span> <span class="c1"># axis A is to the right of axis B</span>
    <span class="k">elif</span> <span class="nb">max</span><span class="p">(</span><span class="n">ay0</span><span class="p">,</span><span class="n">ay1</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">min</span><span class="p">(</span><span class="n">by0</span><span class="p">,</span><span class="n">by1</span><span class="p">):</span> <span class="n">vertical</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># axis A is above B</span>
    <span class="k">elif</span> <span class="nb">max</span><span class="p">(</span><span class="n">by0</span><span class="p">,</span><span class="n">by1</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">min</span><span class="p">(</span><span class="n">ay0</span><span class="p">,</span><span class="n">ay1</span><span class="p">):</span> <span class="n">vertical</span>   <span class="o">=</span>  <span class="mi">1</span> <span class="c1"># axis A is below B</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">horizontal</span> <span class="ow">is</span> <span class="kc">None</span>     <span class="ow">and</span> <span class="n">vertical</span> <span class="ow">is</span> <span class="kc">None</span>    <span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">horizontal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">vertical</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">horizontal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">ax0</span><span class="p">,</span><span class="n">ax1</span><span class="p">)</span> <span class="k">if</span> <span class="n">horizontal</span><span class="o">==-</span><span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">bx0</span><span class="p">,</span><span class="n">bx1</span><span class="p">)))</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">bx0</span><span class="p">,</span><span class="n">bx1</span><span class="p">)</span> <span class="k">if</span> <span class="n">horizontal</span><span class="o">==-</span><span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span><span class="n">ax1</span><span class="p">)))</span>
        <span class="n">span</span>     <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="n">pad</span>      <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">span</span>
        <span class="n">width</span>    <span class="o">=</span> <span class="n">span</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">pad</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">width</span><span class="o">/</span><span class="n">cwidth</span> <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">size</span>
        <span class="n">px</span> <span class="o">=</span> <span class="o">-</span><span class="n">horizontal</span><span class="o">*</span><span class="n">cx</span><span class="o">*</span><span class="n">scale</span> <span class="o">+</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">py</span> <span class="o">=</span> <span class="n">cy</span><span class="o">*</span><span class="n">scale</span> <span class="o">+</span> <span class="p">(</span><span class="n">ay0</span><span class="o">+</span><span class="n">ay1</span><span class="o">+</span><span class="n">by0</span><span class="o">+</span><span class="n">by1</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
        <span class="n">polygon</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="n">px</span><span class="p">,</span><span class="n">py</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="n">BLACK</span><span class="p">)</span><span class="c1">#,transform=tt)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">vertical</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">ay0</span><span class="p">,</span><span class="n">ay1</span><span class="p">)</span> <span class="k">if</span> <span class="n">vertical</span><span class="o">==-</span><span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">by0</span><span class="p">,</span><span class="n">by1</span><span class="p">)))</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">by0</span><span class="p">,</span><span class="n">by1</span><span class="p">)</span> <span class="k">if</span> <span class="n">vertical</span><span class="o">==-</span><span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">ay0</span><span class="p">,</span><span class="n">ay1</span><span class="p">)))</span>
        <span class="n">span</span>     <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="n">pad</span>      <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">span</span>
        <span class="n">width</span>    <span class="o">=</span> <span class="n">span</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">pad</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">width</span><span class="o">/</span><span class="n">cwidth</span> <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">size</span>
        <span class="n">px</span> <span class="o">=</span> <span class="o">-</span><span class="n">vertical</span><span class="o">*</span><span class="n">cx</span><span class="o">*</span><span class="n">scale</span> <span class="o">+</span> <span class="p">(</span><span class="n">y0</span><span class="o">+</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">py</span> <span class="o">=</span> <span class="n">cy</span><span class="o">*</span><span class="n">scale</span> <span class="o">+</span> <span class="p">(</span><span class="n">ax0</span><span class="o">+</span><span class="n">ax1</span><span class="o">+</span><span class="n">bx0</span><span class="o">+</span><span class="n">bx1</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
        <span class="n">polygon</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="n">py</span><span class="p">,</span><span class="n">px</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="n">BLACK</span><span class="p">)</span><span class="c1">#,transform=tt)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="nicey"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.nicey">[docs]</a><span class="k">def</span> <span class="nf">nicey</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Mark only the min/max value of y axis</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span></div>


<div class="viewcode-block" id="nicex"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.nicex">[docs]</a><span class="k">def</span> <span class="nf">nicex</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Mark only the min/max value of x axis</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span></div>


<div class="viewcode-block" id="nicexy"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.nicexy">[docs]</a><span class="k">def</span> <span class="nf">nicexy</span><span class="p">(</span><span class="n">xby</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">yby</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Mark only the min/max value of y/y axis. See ``nicex`` and ``nicey``</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">nicex</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">xby</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">nicey</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">yby</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="hcolorbar"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.hcolorbar">[docs]</a><span class="k">def</span> <span class="nf">hcolorbar</span><span class="p">(</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">sideways</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">spacing</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">shrink</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Matplotlib&#39;s colorbar function is bad. </span>
<span class="sd">    This is less bad.</span>
<span class="sd">    r&#39;$\mathrm{\mu V}^2$&#39;</span>

<span class="sd">    Parameters:</span>
<span class="sd">        vmin     (number)  : min value for colormap</span>
<span class="sd">        vmax     (number)  : mac value for colormap</span>
<span class="sd">        cmap     (colormap): what colormap to use</span>
<span class="sd">        title    (string)  : Units for colormap</span>
<span class="sd">        ax       (axis)    : optional, defaults to plt.gca(). axis to which to add colorbar</span>
<span class="sd">        sideways (bool)    : Flips the axis label sideways</span>
<span class="sd">        border   (bool)    : Draw border around colormap box? </span>
<span class="sd">        spacing  (number)  : distance from axis in pixels. defaults to 5</span>
<span class="sd">        width    (number)  : width of colorbar in pixels. defaults to 15</span>
<span class="sd">        labelpad (number)  : padding between colorbar and title in pixels, defaults to 10</span>
<span class="sd">        fontsize (number)  : label font size, defaults to 12</span>
<span class="sd">    Returns:</span>
<span class="sd">        axis: colorbar axis</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">vmin</span><span class="p">)</span><span class="o">==</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">AxesImage</span><span class="p">:</span>
        <span class="n">img</span>  <span class="o">=</span> <span class="n">vmin</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">()</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_clim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_clim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ax</span>   <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">axes</span>
    <span class="n">oldax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span> <span class="c1">#remember previously active axis</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">SPACING</span> <span class="o">=</span> <span class="n">pixels_to_yfigureunits</span><span class="p">(</span><span class="n">spacing</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">CWIDTH</span>  <span class="o">=</span> <span class="n">pixels_to_yfigureunits</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="c1"># manually add colorbar axes </span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">height</span>
    <span class="n">r</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">xmax</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">ymax</span>
    <span class="n">use</span> <span class="o">=</span> <span class="n">w</span><span class="o">*</span><span class="n">shrink</span>
    <span class="n">extra</span> <span class="o">=</span> <span class="n">w</span><span class="o">-</span><span class="n">use</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">extra</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span>
        <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">w</span><span class="o">+</span><span class="n">pad</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">SPACING</span><span class="p">,</span><span class="n">use</span><span class="p">,</span><span class="n">CWIDTH</span><span class="p">),</span>
        <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
        <span class="n">frameon</span><span class="o">=</span><span class="n">border</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="mi">100</span><span class="p">)]),</span>
        <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">noy</span><span class="p">()</span>
    <span class="n">nicex</span><span class="p">()</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">sideways</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xlim</span><span class="p">()),</span>
            <span class="n">ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">pixels_to_yunits</span><span class="p">(</span><span class="n">labelpad</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">cax</span><span class="p">),</span>
            <span class="n">title</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span>
            <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span>  <span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xlim</span><span class="p">()),</span>
            <span class="n">ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">pixels_to_yunits</span><span class="p">(</span><span class="n">labelpad</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">cax</span><span class="p">),</span>
            <span class="n">title</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span>
            <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span>  <span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
    <span class="c1"># Hide ticks</span>
    <span class="n">noaxis</span><span class="p">()</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
        <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">oldax</span><span class="p">)</span> <span class="c1">#restore previously active axis</span>
    <span class="k">return</span> <span class="n">cax</span></div>


<div class="viewcode-block" id="subfigurelabel"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.subfigurelabel">[docs]</a><span class="k">def</span> <span class="nf">subfigurelabel</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">dx</span><span class="o">=</span><span class="mi">39</span><span class="p">,</span>
    <span class="n">dy</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : label</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">fontproperties</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fontsize&#39;</span><span class="p">:</span><span class="n">fontsize</span><span class="p">,</span>
        <span class="s1">&#39;family&#39;</span><span class="p">:</span><span class="s1">&#39;Bitstream Vera Sans&#39;</span><span class="p">,</span>
        <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span> <span class="k">if</span> <span class="n">bold</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;va&#39;</span><span class="p">:</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ha&#39;</span><span class="p">:</span><span class="s1">&#39;left&#39;</span><span class="p">}</span>
    <span class="n">fontproperties</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">text</span><span class="p">(</span><span class="n">xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">pixels_to_xunits</span><span class="p">(</span><span class="n">dx</span><span class="p">),</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">pixels_to_yunits</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="o">**</span><span class="n">fontproperties</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="pixels_to_xunits"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.pixels_to_xunits">[docs]</a><span class="k">def</span> <span class="nf">pixels_to_xunits</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Converts a measurement in pixels to units of the current x-axis</span>
<span class="sd">    scale</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span>  <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">get_ax_size</span><span class="p">()</span>
    <span class="n">dx</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">dx</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">)</span></div>
<span class="n">px2x</span> <span class="o">=</span> <span class="n">pixels_to_xunits</span>


<div class="viewcode-block" id="pixels_to_yunits"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.pixels_to_yunits">[docs]</a><span class="k">def</span> <span class="nf">pixels_to_yunits</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Converts a measurement in pixels to units of the current y-axis</span>
<span class="sd">    scale</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span>  <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">get_ax_size</span><span class="p">()</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ylim</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">dy</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>
<span class="n">px2y</span> <span class="o">=</span> <span class="n">pixels_to_yunits</span>


<div class="viewcode-block" id="circular_gaussian_smooth"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.circular_gaussian_smooth">[docs]</a><span class="k">def</span> <span class="nf">circular_gaussian_smooth</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sigma</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Smooth signal x with gaussian of standard deviation </span>
<span class="sd">    ``sigma``, circularly wrapped using Fourier transform.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sigma: standard deviation</span>
<span class="sd">    x: 1D array-like signal</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">g</span><span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">)</span></div>


<div class="viewcode-block" id="circularly_smooth_colormap"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.circularly_smooth_colormap">[docs]</a><span class="k">def</span> <span class="nf">circularly_smooth_colormap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Smooth a colormap with cirular boundary conditions</span>

<span class="sd">    s: sigma, standard dev of gaussian smoothing kernel in </span>
<span class="sd">       samples</span>
<span class="sd">    cm: color map, array-like of RGB tuples</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cm : colormap</span>
<span class="sd">    s : smoothing radius</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    RBG : np.ndarray</span>
<span class="sd">        Colormap smoothed with circular boundary conditions.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Do circular boundary conditions the lazy way</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">R</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">T</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">circular_gaussian_smooth</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">circular_gaussian_smooth</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">circular_gaussian_smooth</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">R</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">B</span><span class="p">])</span><span class="o">.</span><span class="n">T</span></div>

<span class="c1"># Colors inspired by Bridget Riley&#39;s &quot;Gather&quot;</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">VIOLET</span><span class="p">,</span>
          <span class="n">MAUVE</span><span class="p">,</span>
          <span class="n">RUST</span><span class="p">,</span>
          <span class="n">OCHRE</span><span class="p">,</span>
          <span class="n">MOSS</span><span class="p">,</span>
          <span class="n">TURQUOISE</span><span class="p">,</span>
          <span class="n">AZURE</span><span class="p">,</span>
          <span class="n">VIOLET</span><span class="p">]</span>
<span class="n">riley0</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span>
    <span class="s1">&#39;riley0&#39;</span><span class="p">,</span><span class="n">colors</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">circularly_smooth_colormap</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">riley0</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)))[:,:</span><span class="mi">3</span><span class="p">],</span><span class="mi">45</span><span class="p">)</span>
<span class="n">riley</span>  <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span>
    <span class="s1">&#39;riley&#39;</span><span class="p">,</span><span class="n">colors</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;riley0&#39;</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">register_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;riley0&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">riley0</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;riley&#39;</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">register_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;riley&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">riley</span><span class="p">)</span>


<span class="c1"># Colors for North South East West Plots</span>
<span class="n">cW</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">.05</span><span class="p">,</span><span class="mf">0.6</span><span class="p">]</span> <span class="c1"># Magenta</span>
<span class="n">cS</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]</span> <span class="c1"># Orange</span>
<span class="n">cE</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.95</span><span class="p">,</span><span class="mf">0.4</span><span class="p">]</span> <span class="c1"># Bright green</span>
<span class="n">cN</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span> <span class="c1"># Azure</span>
<span class="n">colorNSEW</span> <span class="o">=</span> <span class="n">float32</span><span class="p">([</span><span class="n">cN</span><span class="p">,</span><span class="n">cS</span><span class="p">,</span><span class="n">cE</span><span class="p">,</span><span class="n">cW</span><span class="p">])</span>

<span class="c1"># New circular map matching defined colors</span>
<span class="c1"># Order should be W S E N to match plot.riley</span>
<span class="c1"># Soften these slightly by averaging w. riley</span>
<span class="n">cardinal0</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span>
    <span class="s1">&#39;cardinal0&#39;</span><span class="p">,[</span><span class="n">cW</span><span class="p">,</span><span class="n">cS</span><span class="p">,</span><span class="n">cE</span><span class="p">,</span><span class="n">cN</span><span class="p">,</span><span class="n">cW</span><span class="p">])</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">cardinal</span>  <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span>
    <span class="s1">&#39;cardinal&#39;</span><span class="p">,</span><span class="mf">0.52</span><span class="o">*</span><span class="p">(</span><span class="n">riley</span><span class="p">(</span><span class="n">xx</span><span class="p">)[:,:</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">circularly_smooth_colormap</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cardinal0</span><span class="p">(</span><span class="n">xx</span><span class="p">))[:,:</span><span class="mi">3</span><span class="p">],</span><span class="mi">45</span><span class="p">)))</span>
<span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;cardinal&#39;</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">register_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;cardinal&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cardinal</span><span class="p">)</span>
<span class="n">cardinal</span>

    
<div class="viewcode-block" id="force_aspect"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.force_aspect">[docs]</a><span class="k">def</span> <span class="nf">force_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    aspect : aspect ratio</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">))</span><span class="o">/</span><span class="n">aspect</span><span class="p">)</span></div>
<span class="w">    </span>
<span class="w">    </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Plotting routines specific to the GP code</span>
<span class="sd">&quot;&quot;&quot;</span>

<div class="viewcode-block" id="pscale"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.pscale">[docs]</a><span class="k">def</span> <span class="nf">pscale</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">q1</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">q2</span><span class="o">=</span><span class="mf">99.5</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot helper: Scale data by percentiles</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x: np.float32</span>
<span class="sd">    </span>
<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    q1: float in (0,1); default 0.5</span>
<span class="sd">        Fraction of data below which we will set to zero.</span>
<span class="sd">    q2: float in (0,1); default 0.95</span>
<span class="sd">        Fraction of data above which we will set to one.</span>
<span class="sd">    mask: np.bool; default None</span>
<span class="sd">        Subset of points to consider </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result: np.array</span>
<span class="sd">        Rescaled data</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">u</span>  <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span>
    <span class="n">u</span>  <span class="o">=</span> <span class="n">float32</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">nanpercentile</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">q1</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">nanpercentile</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">q2</span><span class="p">)</span>
    <span class="n">x</span>  <span class="o">=</span> <span class="n">clip</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">p1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">p2</span><span class="o">-</span><span class="n">p1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">mask</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span></div>
    

<div class="viewcode-block" id="showkn"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.showkn">[docs]</a><span class="k">def</span> <span class="nf">showkn</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot helper; Re-center a FFT convolution kernel and</span>
<span class="sd">    plot it. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">k</span><span class="p">));</span> <span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">t</span><span class="p">);</span></div>


<div class="viewcode-block" id="showim"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.showim">[docs]</a><span class="k">def</span> <span class="nf">showim</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot helper: Show image with title, no axes</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> 
        <span class="n">L</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pscale</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">));</span>
    <span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
    <span class="n">title</span><span class="p">(</span><span class="n">t</span><span class="p">);</span></div>
    

<div class="viewcode-block" id="inference_summary_plot"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.inference_summary_plot">[docs]</a><span class="k">def</span> <span class="nf">inference_summary_plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">fit</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">ftitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Summarize the result of log-Gaussian process variational </span>
<span class="sd">    inference in four plots.</span>
<span class="sd">    </span>
<span class="sd">    This function exists to simplify the example notebooks,</span>
<span class="sd">    and isn&#39;t designed for general use. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model: lgcp2d.DiagonalFourierLowrank</span>
<span class="sd">        Initialized model</span>
<span class="sd">    fit: tuple</span>
<span class="sd">        Tuple of (low-rank mean, marginal variance, loss)</span>
<span class="sd">        returned by ``lgcp2d.coordinate_descent()``.</span>
<span class="sd">    data: loaddata.Dataset</span>
<span class="sd">        Prepared dataset</span>
<span class="sd">    ftitle: str</span>
<span class="sd">        Figure title</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">y</span>       <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span>
    <span class="n">L</span>       <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">L</span>
    <span class="n">mask</span>    <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">arena</span><span class="o">.</span><span class="n">mask</span>
    <span class="n">nanmask</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">arena</span><span class="o">.</span><span class="n">nanmask</span>
    <span class="n">Fs</span>      <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">position_sample_rate</span>
    <span class="n">scale</span>   <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">scale</span>
    <span class="n">μz</span>      <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">prior_mean</span>
    <span class="n">μh</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">_</span>  <span class="o">=</span> <span class="n">fit</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    
    <span class="c1"># Convert from frequency to spatial coordinates and add back prior mean</span>
    <span class="n">μ</span>  <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">F</span><span class="o">.</span><span class="n">T</span><span class="nd">@μh</span><span class="o">+</span><span class="n">μz</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">μλ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">μ</span><span class="o">+</span><span class="n">v</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">Fs</span>
    <span class="n">vλ</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">μ</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">Fs</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">σλ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vλ</span><span class="p">)</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">σλ</span><span class="o">/</span><span class="n">μλ</span>
    
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;bone_r&#39;</span><span class="p">)</span>
    
    <span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mf">2.5</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
    <span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="p">{}</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">subplot</span><span class="p">(</span><span class="mi">141</span><span class="p">)</span>
    <span class="n">toshow</span> <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="n">Fs</span><span class="o">*</span><span class="n">nanmask</span>
    <span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span> <span class="o">=</span> <span class="n">nanpercentile</span><span class="p">(</span><span class="n">toshow</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">99</span><span class="p">])</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">vmin</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="n">ceil</span> <span class="p">(</span><span class="n">vmax</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">toshow</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rate histogram &quot;y&quot;&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="c1"># Add a scale bar</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">scale</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">L</span><span class="o">//</span><span class="mi">25</span>
    <span class="n">xscalebar</span><span class="p">((</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">,</span><span class="s1">&#39;1 m&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y0</span><span class="p">)</span>
    <span class="c1"># Add color bar with marker for neurons mean-rate</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">good_colorbar</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hz&#39;</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">vscale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">sca</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
    <span class="n">μy</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span><span class="o">*</span><span class="n">Fs</span>
    <span class="n">axhline</span><span class="p">(</span><span class="n">μy</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">text</span><span class="p">(</span><span class="n">xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.6</span><span class="p">,</span><span class="n">μy</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\langle y \rangle$=</span><span class="si">%0.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">μy</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">subplot</span><span class="p">(</span><span class="mi">143</span><span class="p">)</span>
    <span class="c1">#vmin,vmax = nanpercentile(μλ[mask],[.5,99.5])</span>
    <span class="c1">#vmin = floor(vmin*10)/10</span>
    <span class="c1">#vmax = ceil (vmax*10)/10</span>
    <span class="n">q</span> <span class="o">=</span> <span class="mf">.5</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">L</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
        <span class="n">μλ</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">nanmask</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">q</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">arena</span><span class="o">.</span><span class="n">perimeter</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">title</span><span class="p">(</span><span class="s1">&#39;Posterior mean $</span><span class="se">\\</span><span class="s1">langle \lambda</span><span class="se">\\</span><span class="s1">rangle$&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">good_colorbar</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hz&#39;</span><span class="p">,</span>
                  <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">vscale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">subplot</span><span class="p">(</span><span class="mi">142</span><span class="p">)</span>
    <span class="n">toshow</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">μ</span><span class="o">-</span><span class="n">μz</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">nanmask</span>
    <span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span> <span class="o">=</span> <span class="n">nanpercentile</span><span class="p">(</span><span class="n">toshow</span><span class="p">,[</span><span class="mf">.25</span><span class="p">,</span><span class="mf">99.75</span><span class="p">])</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">vmin</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="n">ceil</span> <span class="p">(</span><span class="n">vmax</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
        <span class="n">toshow</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">q</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">arena</span><span class="o">.</span><span class="n">perimeter</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">title</span><span class="p">(</span><span class="s1">&#39;Posterior mean (Δ log-rate)&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">good_colorbar</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;ΔdB from background&#39;</span><span class="p">,</span>
                  <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">vscale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="n">subplot</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
    <span class="n">toshow</span> <span class="o">=</span> <span class="n">cv</span><span class="o">*</span><span class="n">nanmask</span>
    <span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span> <span class="o">=</span> <span class="n">nanpercentile</span><span class="p">(</span><span class="n">toshow</span><span class="p">,[</span><span class="mf">.5</span><span class="p">,</span><span class="mf">99.5</span><span class="p">])</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">vmin</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="n">ceil</span> <span class="p">(</span><span class="n">vmax</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
        <span class="n">toshow</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">q</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">arena</span><span class="o">.</span><span class="n">perimeter</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">title</span><span class="p">(</span><span class="s1">&#39;Marginal c.v. of λ (σ/μ)&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">good_colorbar</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;σ/μ&#39;</span><span class="p">,</span>
                  <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">vscale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
    <span class="n">suptitle</span><span class="p">(</span><span class="n">ftitle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_convex_hull"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.plot_convex_hull">[docs]</a><span class="k">def</span> <span class="nf">plot_convex_hull</span><span class="p">(</span><span class="n">px</span><span class="p">,</span><span class="n">py</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate convex hull of points (px,py) and plot it.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    px: length NPOINTS 1D np.float32</span>
<span class="sd">    py: length NPOINTS 1D np.float32</span>
<span class="sd">    </span>
<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    **kwargs: dict</span>
<span class="sd">        Keyword arguments are forwarded to ``pyplot.plot()``        </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result: ConvexHull(points)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">px</span><span class="p">,</span><span class="n">py</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="n">hull</span>   <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">vv</span>     <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="n">hull</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">vv</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">points</span><span class="p">[</span><span class="n">vv</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hull</span></div>


<div class="viewcode-block" id="unit_crosshairs"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.unit_crosshairs">[docs]</a><span class="k">def</span> <span class="nf">unit_crosshairs</span><span class="p">(</span><span class="n">draw_ellipse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">draw_cross</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">lines</span>  <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">draw_ellipse</span><span class="p">:</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">361</span><span class="p">))</span>
        <span class="n">lines</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">draw_cross</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">.4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">lines</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">.4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">lines</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">lines</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">draw_cross</span><span class="o">==</span><span class="s1">&#39;full&#39;</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">lines</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lines</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">lines</span><span class="o">.</span><span class="n">imag</span><span class="p">])</span></div>

    
<div class="viewcode-block" id="covellipse_from_points"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.covellipse_from_points">[docs]</a><span class="k">def</span> <span class="nf">covellipse_from_points</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Helper to construct covariance ellipse from </span>
<span class="sd">    collection of 2D points ``q`` encoded as complex numbers.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">isfinite</span><span class="p">(</span><span class="n">q</span><span class="p">)]</span>
    <span class="n">pxy</span> <span class="o">=</span> <span class="n">c2p</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">μ</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">pxy</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Δ</span> <span class="o">=</span> <span class="n">pxy</span><span class="o">-</span><span class="n">μ</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">Σ</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">Δ</span><span class="p">[:,</span><span class="kc">None</span><span class="p">,:]</span><span class="o">*</span><span class="n">Δ</span><span class="p">[</span><span class="kc">None</span><span class="p">,:,:],</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p2c</span><span class="p">(</span><span class="n">covariance_crosshairs</span><span class="p">(</span><span class="n">Σ</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">+</span> <span class="n">μ</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span></div>


<div class="viewcode-block" id="covariance_crosshairs"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.covariance_crosshairs">[docs]</a><span class="k">def</span> <span class="nf">covariance_crosshairs</span><span class="p">(</span>
    <span class="n">S</span><span class="p">,</span>
    <span class="n">p</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
    <span class="n">draw_ellipse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">draw_cross</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;2D&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    For 2D Gaussians these are the confidence intervals</span>
<span class="sd">    </span>
<span class="sd">        p   | sigma</span>
<span class="sd">        90  : 4.605</span>
<span class="sd">        95  : 5.991</span>
<span class="sd">        97.5: 7.378</span>
<span class="sd">        99  : 9.210</span>
<span class="sd">        99.5: 10.597</span>

<span class="sd">    - Get the eigenvalues and vectors of covariance S</span>
<span class="sd">    - Prepare crosshairs for a unit standard normal</span>
<span class="sd">    - Transform crosshairs into covariance basis</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    S: 2D covariance matrix</span>
<span class="sd">    p: fraction of data ellipse should enclose</span>
<span class="sd">    draw_ellipse: whether to draw the ellipse</span>
<span class="sd">    draw_cross: whether to draw the crosshairs</span>
<span class="sd">    mode: 2D or 1D; </span>
<span class="sd">        If 2D, ellipse will reflect inner p of probability</span>
<span class="sd">        mass</span>
<span class="sd">        If 1D, ellipse will represent threshold for p </span>
<span class="sd">        significance for a 1-tailed test in any direction.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    path: np.float32</span>
<span class="sd">        2×NPOINTS array of (x,y) path data for plotting</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;S should be a 2x2 covariance &#39;</span>
                         <span class="s1">&#39;matrix, got </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">S</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;2D&#39;</span><span class="p">:</span>
        <span class="c1"># Points in any direction within percentile</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">mode</span><span class="o">==</span><span class="s1">&#39;1D&#39;</span><span class="p">:</span>
        <span class="c1"># Displacement in specific direction within %ile</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mode must be &#39;2D&#39; or &#39;1D&#39;&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">e</span><span class="p">,</span><span class="n">v</span>   <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Could not get covariance &#39;</span>
            <span class="s1">&#39;eigenspace, is S=</span><span class="si">%s</span><span class="s1"> full-rank?&#39;</span><span class="o">%</span><span class="nb">repr</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
    <span class="n">e</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">unit_crosshairs</span><span class="p">(</span><span class="n">draw_ellipse</span><span class="p">,</span><span class="n">draw_cross</span><span class="p">)</span><span class="o">*</span><span class="n">sigma</span>
    <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lines</span><span class="o">*</span><span class="p">(</span><span class="n">e</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">])</span></div>


<div class="viewcode-block" id="good_colorbar"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.good_colorbar">[docs]</a><span class="k">def</span> <span class="nf">good_colorbar</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">sideways</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">spacing</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">vscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Matplotlib&#39;s colorbar function is pretty bad. </span>
<span class="sd">    This is less bad.</span>
<span class="sd">    r&#39;$\mathrm{\mu V}^2$&#39;</span>

<span class="sd">    Parameters:</span>
<span class="sd">        vmin: scalar</span>
<span class="sd">            min value for colormap</span>
<span class="sd">        vmax: scalar</span>
<span class="sd">            max value for colormap</span>
<span class="sd">        cmap: Matplotlib.colormap</span>
<span class="sd">            what colormap to use</span>
<span class="sd">        title: str</span>
<span class="sd">            Units for colormap</span>
<span class="sd">        ax: axis</span>
<span class="sd">            Optional, defaults to plt.gca(). </span>
<span class="sd">            Axis to which to add colorbar</span>
<span class="sd">        sideways: bool</span>
<span class="sd">            Flip the axis label sideways?</span>
<span class="sd">        border: bool</span>
<span class="sd">            Draw border around colormap box? </span>
<span class="sd">        spacing: scalar</span>
<span class="sd">            Distance from axis in pixels. </span>
<span class="sd">            defaults to 5</span>
<span class="sd">        width: scalar</span>
<span class="sd">            Width of colorbar in pixels. </span>
<span class="sd">            Defaults to 15</span>
<span class="sd">        labelpad: scalar</span>
<span class="sd">            Padding between colorbar and title in pixels, </span>
<span class="sd">            defaults to 10</span>
<span class="sd">        fontsize: scalar</span>
<span class="sd">            Label font size, defaults to 12</span>
<span class="sd">        vscale: float</span>
<span class="sd">            Height adjustment relative to parent axis, </span>
<span class="sd">            defaults to 1.0</span>
<span class="sd">        va: str</span>
<span class="sd">            Verrtical alignment; &quot;bottom&quot; (&#39;b&#39;), </span>
<span class="sd">            &quot;center&quot; (&#39;c&#39;), or &quot;top&quot; (&#39;t&#39;)</span>
<span class="sd">    Returns:</span>
<span class="sd">        axis: colorbar axis</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">vmin</span><span class="p">)</span><span class="o">==</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">AxesImage</span><span class="p">:</span>
        <span class="n">img</span>  <span class="o">=</span> <span class="n">vmin</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">()</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_clim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_clim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ax</span>   <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">axes</span>
    <span class="n">oldax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span> <span class="c1">#remember previously active axis</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">SPACING</span> <span class="o">=</span> <span class="n">pixels_to_xfigureunits</span><span class="p">(</span><span class="n">spacing</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">CWIDTH</span>  <span class="o">=</span> <span class="n">pixels_to_xfigureunits</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="c1"># manually add colorbar axes </span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">height</span>
    <span class="n">r</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">xmax</span><span class="p">,</span><span class="n">bb</span><span class="o">.</span><span class="n">ymax</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="k">lambda</span><span class="p">:</span><span class="n">b</span><span class="o">-</span><span class="n">h</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="k">lambda</span><span class="p">:</span><span class="n">b</span><span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">vscale</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="k">lambda</span><span class="p">:</span><span class="n">b</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">vscale</span>
    <span class="p">}[</span><span class="n">va</span><span class="p">[</span><span class="mi">0</span><span class="p">]]()</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span>
        <span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="n">SPACING</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">CWIDTH</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">vscale</span><span class="p">),</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmax</span><span class="p">,</span><span class="n">vmin</span><span class="p">,</span><span class="mi">100</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
        <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">),</span>
        <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">nox</span><span class="p">()</span>
    <span class="n">nicey</span><span class="p">()</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">sideways</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">pixels_to_xunits</span><span class="p">(</span><span class="n">labelpad</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">cax</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ylim</span><span class="p">()),</span>
            <span class="n">title</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span>
            <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span>  <span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">pixels_to_xunits</span><span class="p">(</span><span class="n">labelpad</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">cax</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ylim</span><span class="p">()),</span>
            <span class="n">title</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span>
            <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span>  <span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="c1"># Hide ticks</span>
    <span class="c1">#noaxis()</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
        <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">oldax</span><span class="p">)</span> <span class="c1">#restore previously active axis</span>
    <span class="k">return</span> <span class="n">cax</span></div>

<div class="viewcode-block" id="draw_compass"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.draw_compass">[docs]</a><span class="k">def</span> <span class="nf">draw_compass</span><span class="p">(</span>
    <span class="n">xy0</span><span class="o">=</span><span class="mf">1.1</span><span class="o">+</span><span class="mf">.65</span><span class="n">j</span><span class="p">,</span>
    <span class="n">r</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
    <span class="n">cmap_fn</span><span class="o">=</span><span class="n">riley</span><span class="p">,</span>
    <span class="n">delta</span><span class="o">=</span><span class="mi">18</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Draw a hue-wheel compass rose.</span>
<span class="sd">    Equivalent of &quot;colorbar&quot; for polar data.</span>
<span class="sd">    </span>
<span class="sd">    This uses plot-coordinates for drawing, and assumes</span>
<span class="sd">    that the plot&#39;s aspect-ratio is equal. </span>


<span class="sd">    This is designed to be used with the ``riley`` </span>
<span class="sd">    colormap from ``lgcpspatial.plot``. This map starts at </span>
<span class="sd">    mauve, continues through rust, olive, blue, before </span>
<span class="sd">    circling back to mauve. We use these color–direction</span>
<span class="sd">    conventions: </span>
<span class="sd">    </span>
<span class="sd">     - North: blue/azure/cyan</span>
<span class="sd">     - South: red/rust</span>
<span class="sd">     - East:  green/olive</span>
<span class="sd">     - West:  purple/mauve/magenta</span>
<span class="sd">    </span>
<span class="sd">    For comatibility, then, the direction ordering</span>
<span class="sd">    for the colormap parameter ``color`` should be</span>
<span class="sd">    </span>
<span class="sd">        {West, South, East, North}</span>

<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xy0: np.complex64</span>
<span class="sd">        Center of compass encoded as x+iy complex number.</span>
<span class="sd">    r: positive float; default 0.03</span>
<span class="sd">        Size of compass (radius of circle).</span>
<span class="sd">    cmap_fn: matplotlib.colors.Colormap</span>
<span class="sd">        circular colormap to use for compass.</span>
<span class="sd">    delta: positive float</span>
<span class="sd">        Radial spacing for NSEW labels relative to the</span>
<span class="sd">        color wheel. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">y0</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">ylim</span><span class="p">()</span>
    <span class="n">flip</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">y1</span><span class="o">&lt;</span><span class="n">y0</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">θi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span><span class="mi">180</span><span class="p">)</span><span class="o">+</span><span class="n">pi</span><span class="p">):</span>
        <span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">c2p</span><span class="p">(</span><span class="n">xy0</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">flip</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">θi</span><span class="p">)),</span>
                <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">cmap_fn</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">180</span><span class="p">),</span>
                <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">tx</span><span class="p">,</span><span class="n">ty</span> <span class="o">=</span> <span class="n">c2p</span><span class="p">(</span><span class="n">xy0</span><span class="p">)</span>
    <span class="n">dx</span><span class="p">,</span><span class="n">dy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">px2x</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span><span class="o">+</span><span class="n">r</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">px2y</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span><span class="o">+</span><span class="n">r</span>
    <span class="c1"># There&#39;s a bug here; assume axis is always square</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="o">+</span><span class="n">dy</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">dy</span><span class="o">*=</span><span class="n">flip</span>
    <span class="n">text</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="o">+</span><span class="n">dy</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">text</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="o">-</span><span class="n">dy</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">text</span><span class="p">(</span><span class="n">tx</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">ty</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">text</span><span class="p">(</span><span class="n">tx</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">ty</span><span class="p">,</span><span class="s1">&#39;W&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span></div>

<span class="n">roma_cm_data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">.49684</span><span class="p">,</span><span class="mf">0.099626</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">.50141</span><span class="p">,</span><span class="mf">0.11159</span><span class="p">,</span><span class="mf">0.0038271</span><span class="p">],[</span><span class="mf">.50595</span><span class="p">,</span><span class="mf">0.12281</span><span class="p">,</span><span class="mf">0.0075362</span><span class="p">],[</span><span class="mf">.51049</span><span class="p">,</span><span class="mf">0.13362</span><span class="p">,</span><span class="mf">0.011176</span><span class="p">],[</span><span class="mf">.51502</span><span class="p">,</span><span class="mf">0.14397</span><span class="p">,</span><span class="mf">0.014691</span><span class="p">],[</span><span class="mf">.51953</span><span class="p">,</span><span class="mf">0.15397</span><span class="p">,</span><span class="mf">0.017936</span><span class="p">],[</span><span class="mf">.52403</span><span class="p">,</span><span class="mf">0.16373</span><span class="p">,</span><span class="mf">0.02102</span><span class="p">],[</span><span class="mf">.52851</span><span class="p">,</span><span class="mf">0.17319</span><span class="p">,</span><span class="mf">0.023941</span><span class="p">],[</span><span class="mf">.53298</span><span class="p">,</span><span class="mf">0.18247</span><span class="p">,</span><span class="mf">0.026768</span><span class="p">],[</span><span class="mf">.53742</span><span class="p">,</span><span class="mf">0.19159</span><span class="p">,</span><span class="mf">0.02974</span><span class="p">],[</span><span class="mf">.54181</span><span class="p">,</span><span class="mf">0.20053</span><span class="p">,</span><span class="mf">0.032886</span><span class="p">],[</span><span class="mf">.5462</span><span class="p">,</span><span class="mf">0.20938</span><span class="p">,</span><span class="mf">0.036371</span><span class="p">],[</span><span class="mf">.55055</span><span class="p">,</span><span class="mf">0.2181</span><span class="p">,</span><span class="mf">0.03985</span><span class="p">],[</span><span class="mf">.55486</span><span class="p">,</span><span class="mf">0.22671</span><span class="p">,</span><span class="mf">0.043275</span><span class="p">],[</span><span class="mf">.55915</span><span class="p">,</span><span class="mf">0.23522</span><span class="p">,</span><span class="mf">0.046908</span><span class="p">],[</span><span class="mf">.56342</span><span class="p">,</span><span class="mf">0.24362</span><span class="p">,</span><span class="mf">0.050381</span><span class="p">],[</span><span class="mf">.56764</span><span class="p">,</span><span class="mf">0.25199</span><span class="p">,</span><span class="mf">0.053844</span><span class="p">],[</span><span class="mf">.57184</span><span class="p">,</span><span class="mf">0.26026</span><span class="p">,</span><span class="mf">0.057332</span><span class="p">],[</span><span class="mf">.57601</span><span class="p">,</span><span class="mf">0.26848</span><span class="p">,</span><span class="mf">0.06081</span><span class="p">],[</span><span class="mf">.58015</span><span class="p">,</span><span class="mf">0.27665</span><span class="p">,</span><span class="mf">0.064287</span><span class="p">],[</span><span class="mf">.58425</span><span class="p">,</span><span class="mf">0.28474</span><span class="p">,</span><span class="mf">0.067738</span><span class="p">],[</span><span class="mf">.58833</span><span class="p">,</span><span class="mf">0.29281</span><span class="p">,</span><span class="mf">0.071178</span><span class="p">],[</span><span class="mf">.59239</span><span class="p">,</span><span class="mf">0.30083</span><span class="p">,</span><span class="mf">0.074547</span><span class="p">],[</span><span class="mf">.59641</span><span class="p">,</span><span class="mf">0.30883</span><span class="p">,</span><span class="mf">0.077891</span><span class="p">],[</span><span class="mf">.60041</span><span class="p">,</span><span class="mf">0.31677</span><span class="p">,</span><span class="mf">0.081344</span><span class="p">],[</span><span class="mf">.60439</span><span class="p">,</span><span class="mf">0.32468</span><span class="p">,</span><span class="mf">0.084709</span><span class="p">],[</span><span class="mf">.60834</span><span class="p">,</span><span class="mf">0.33258</span><span class="p">,</span><span class="mf">0.088059</span><span class="p">],[</span><span class="mf">.61225</span><span class="p">,</span><span class="mf">0.34043</span><span class="p">,</span><span class="mf">0.091425</span><span class="p">],[</span><span class="mf">.61616</span><span class="p">,</span><span class="mf">0.34827</span><span class="p">,</span><span class="mf">0.094762</span><span class="p">],[</span><span class="mf">.62004</span><span class="p">,</span><span class="mf">0.35608</span><span class="p">,</span><span class="mf">0.098071</span><span class="p">],[</span><span class="mf">.6239</span><span class="p">,</span><span class="mf">0.36387</span><span class="p">,</span><span class="mf">0.10135</span><span class="p">],[</span><span class="mf">.62774</span><span class="p">,</span><span class="mf">0.37164</span><span class="p">,</span><span class="mf">0.10462</span><span class="p">],[</span><span class="mf">.63157</span><span class="p">,</span><span class="mf">0.37941</span><span class="p">,</span><span class="mf">0.10794</span><span class="p">],[</span><span class="mf">.63537</span><span class="p">,</span><span class="mf">0.38716</span><span class="p">,</span><span class="mf">0.11129</span><span class="p">],[</span><span class="mf">.63916</span><span class="p">,</span><span class="mf">0.3949</span><span class="p">,</span><span class="mf">0.11452</span><span class="p">],[</span><span class="mf">.64294</span><span class="p">,</span><span class="mf">0.40263</span><span class="p">,</span><span class="mf">0.11786</span><span class="p">],[</span><span class="mf">.64671</span><span class="p">,</span><span class="mf">0.41037</span><span class="p">,</span><span class="mf">0.12112</span><span class="p">],[</span><span class="mf">.65046</span><span class="p">,</span><span class="mf">0.41807</span><span class="p">,</span><span class="mf">0.12443</span><span class="p">],[</span><span class="mf">.65421</span><span class="p">,</span><span class="mf">0.42579</span><span class="p">,</span><span class="mf">0.12776</span><span class="p">],[</span><span class="mf">.65795</span><span class="p">,</span><span class="mf">0.43351</span><span class="p">,</span><span class="mf">0.13108</span><span class="p">],[</span><span class="mf">.66169</span><span class="p">,</span><span class="mf">0.44123</span><span class="p">,</span><span class="mf">0.13442</span><span class="p">],[</span><span class="mf">.66541</span><span class="p">,</span><span class="mf">0.44896</span><span class="p">,</span><span class="mf">0.13776</span><span class="p">],[</span><span class="mf">.66914</span><span class="p">,</span><span class="mf">0.45668</span><span class="p">,</span><span class="mf">0.14112</span><span class="p">],[</span><span class="mf">.67287</span><span class="p">,</span><span class="mf">0.46443</span><span class="p">,</span><span class="mf">0.1445</span><span class="p">],[</span><span class="mf">.6766</span><span class="p">,</span><span class="mf">0.47218</span><span class="p">,</span><span class="mf">0.1479</span><span class="p">],[</span><span class="mf">.68033</span><span class="p">,</span><span class="mf">0.47994</span><span class="p">,</span><span class="mf">0.15134</span><span class="p">],[</span><span class="mf">.68407</span><span class="p">,</span><span class="mf">0.48772</span><span class="p">,</span><span class="mf">0.15484</span><span class="p">],[</span><span class="mf">.68783</span><span class="p">,</span><span class="mf">0.49551</span><span class="p">,</span><span class="mf">0.1584</span><span class="p">],[</span><span class="mf">.69159</span><span class="p">,</span><span class="mf">0.50332</span><span class="p">,</span><span class="mf">0.162</span><span class="p">],[</span><span class="mf">.69537</span><span class="p">,</span><span class="mf">0.51117</span><span class="p">,</span><span class="mf">0.1656</span><span class="p">],[</span><span class="mf">.69916</span><span class="p">,</span><span class="mf">0.51905</span><span class="p">,</span><span class="mf">0.16938</span><span class="p">],[</span><span class="mf">.70298</span><span class="p">,</span><span class="mf">0.52695</span><span class="p">,</span><span class="mf">0.17315</span><span class="p">],[</span><span class="mf">.70681</span><span class="p">,</span><span class="mf">0.53488</span><span class="p">,</span><span class="mf">0.17706</span><span class="p">],[</span><span class="mf">.71067</span><span class="p">,</span><span class="mf">0.54285</span><span class="p">,</span><span class="mf">0.18103</span><span class="p">],[</span><span class="mf">.71456</span><span class="p">,</span><span class="mf">0.55087</span><span class="p">,</span><span class="mf">0.18517</span><span class="p">],[</span><span class="mf">.71848</span><span class="p">,</span><span class="mf">0.55892</span><span class="p">,</span><span class="mf">0.18939</span><span class="p">],[</span><span class="mf">.72244</span><span class="p">,</span><span class="mf">0.56704</span><span class="p">,</span><span class="mf">0.19377</span><span class="p">],[</span><span class="mf">.72644</span><span class="p">,</span><span class="mf">0.57519</span><span class="p">,</span><span class="mf">0.19826</span><span class="p">],[</span><span class="mf">.73049</span><span class="p">,</span><span class="mf">0.5834</span><span class="p">,</span><span class="mf">0.20295</span><span class="p">],[</span><span class="mf">.73457</span><span class="p">,</span><span class="mf">0.59168</span><span class="p">,</span><span class="mf">0.20781</span><span class="p">],[</span><span class="mf">.7387</span><span class="p">,</span><span class="mf">0.60002</span><span class="p">,</span><span class="mf">0.21285</span><span class="p">],[</span><span class="mf">.74289</span><span class="p">,</span><span class="mf">0.60842</span><span class="p">,</span><span class="mf">0.21813</span><span class="p">],[</span><span class="mf">.74712</span><span class="p">,</span><span class="mf">0.61688</span><span class="p">,</span><span class="mf">0.22361</span><span class="p">],[</span><span class="mf">.75142</span><span class="p">,</span><span class="mf">0.6254</span><span class="p">,</span><span class="mf">0.22933</span><span class="p">],[</span><span class="mf">.75576</span><span class="p">,</span><span class="mf">0.634</span><span class="p">,</span><span class="mf">0.23533</span><span class="p">],[</span><span class="mf">.76016</span><span class="p">,</span><span class="mf">0.64265</span><span class="p">,</span><span class="mf">0.24156</span><span class="p">],[</span><span class="mf">.76463</span><span class="p">,</span><span class="mf">0.65137</span><span class="p">,</span><span class="mf">0.24809</span><span class="p">],[</span><span class="mf">.76914</span><span class="p">,</span><span class="mf">0.66014</span><span class="p">,</span><span class="mf">0.2549</span><span class="p">],[</span><span class="mf">.77371</span><span class="p">,</span><span class="mf">0.66897</span><span class="p">,</span><span class="mf">0.262</span><span class="p">],[</span><span class="mf">.77833</span><span class="p">,</span><span class="mf">0.67784</span><span class="p">,</span><span class="mf">0.26943</span><span class="p">],[</span><span class="mf">.783</span><span class="p">,</span><span class="mf">0.68674</span><span class="p">,</span><span class="mf">0.27716</span><span class="p">],[</span><span class="mf">.78771</span><span class="p">,</span><span class="mf">0.69568</span><span class="p">,</span><span class="mf">0.2852</span><span class="p">],[</span><span class="mf">.79246</span><span class="p">,</span><span class="mf">0.70462</span><span class="p">,</span><span class="mf">0.29358</span><span class="p">],[</span><span class="mf">.79722</span><span class="p">,</span><span class="mf">0.71357</span><span class="p">,</span><span class="mf">0.30227</span><span class="p">],[</span><span class="mf">.80201</span><span class="p">,</span><span class="mf">0.72249</span><span class="p">,</span><span class="mf">0.31128</span><span class="p">],[</span><span class="mf">.80681</span><span class="p">,</span><span class="mf">0.73138</span><span class="p">,</span><span class="mf">0.32059</span><span class="p">],[</span><span class="mf">.81159</span><span class="p">,</span><span class="mf">0.74021</span><span class="p">,</span><span class="mf">0.33017</span><span class="p">],[</span><span class="mf">.81635</span><span class="p">,</span><span class="mf">0.74896</span><span class="p">,</span><span class="mf">0.34004</span><span class="p">],[</span><span class="mf">.82108</span><span class="p">,</span><span class="mf">0.75761</span><span class="p">,</span><span class="mf">0.35015</span><span class="p">],[</span><span class="mf">.82576</span><span class="p">,</span><span class="mf">0.76614</span><span class="p">,</span><span class="mf">0.36047</span><span class="p">],[</span><span class="mf">.83037</span><span class="p">,</span><span class="mf">0.77452</span><span class="p">,</span><span class="mf">0.37103</span><span class="p">],[</span><span class="mf">.8349</span><span class="p">,</span><span class="mf">0.78274</span><span class="p">,</span><span class="mf">0.38176</span><span class="p">],[</span><span class="mf">.83934</span><span class="p">,</span><span class="mf">0.79077</span><span class="p">,</span><span class="mf">0.39264</span><span class="p">],[</span><span class="mf">.84366</span><span class="p">,</span><span class="mf">0.7986</span><span class="p">,</span><span class="mf">0.40365</span><span class="p">],[</span><span class="mf">.84785</span><span class="p">,</span><span class="mf">0.80619</span><span class="p">,</span><span class="mf">0.41475</span><span class="p">],[</span><span class="mf">.8519</span><span class="p">,</span><span class="mf">0.81354</span><span class="p">,</span><span class="mf">0.42591</span><span class="p">],[</span><span class="mf">.8558</span><span class="p">,</span><span class="mf">0.82064</span><span class="p">,</span><span class="mf">0.43711</span><span class="p">],[</span><span class="mf">.85953</span><span class="p">,</span><span class="mf">0.82748</span><span class="p">,</span><span class="mf">0.44831</span><span class="p">],[</span><span class="mf">.86308</span><span class="p">,</span><span class="mf">0.83404</span><span class="p">,</span><span class="mf">0.4595</span><span class="p">],[</span><span class="mf">.86643</span><span class="p">,</span><span class="mf">0.84031</span><span class="p">,</span><span class="mf">0.47065</span><span class="p">],[</span><span class="mf">.86958</span><span class="p">,</span><span class="mf">0.84629</span><span class="p">,</span><span class="mf">0.48173</span><span class="p">],[</span><span class="mf">.87253</span><span class="p">,</span><span class="mf">0.85199</span><span class="p">,</span><span class="mf">0.49272</span><span class="p">],[</span><span class="mf">.87526</span><span class="p">,</span><span class="mf">0.8574</span><span class="p">,</span><span class="mf">0.50362</span><span class="p">],[</span><span class="mf">.87777</span><span class="p">,</span><span class="mf">0.86254</span><span class="p">,</span><span class="mf">0.51441</span><span class="p">],[</span><span class="mf">.88004</span><span class="p">,</span><span class="mf">0.86739</span><span class="p">,</span><span class="mf">0.52506</span><span class="p">],[</span><span class="mf">.88209</span><span class="p">,</span><span class="mf">0.87197</span><span class="p">,</span><span class="mf">0.53557</span><span class="p">],[</span><span class="mf">.8839</span><span class="p">,</span><span class="mf">0.87629</span><span class="p">,</span><span class="mf">0.54595</span><span class="p">],[</span><span class="mf">.88546</span><span class="p">,</span><span class="mf">0.88035</span><span class="p">,</span><span class="mf">0.55615</span><span class="p">],[</span><span class="mf">.88677</span><span class="p">,</span><span class="mf">0.88417</span><span class="p">,</span><span class="mf">0.56622</span><span class="p">],[</span><span class="mf">.88783</span><span class="p">,</span><span class="mf">0.88775</span><span class="p">,</span><span class="mf">0.57613</span><span class="p">],[</span><span class="mf">.88864</span><span class="p">,</span><span class="mf">0.89111</span><span class="p">,</span><span class="mf">0.58587</span><span class="p">],[</span><span class="mf">.88918</span><span class="p">,</span><span class="mf">0.89426</span><span class="p">,</span><span class="mf">0.59544</span><span class="p">],[</span><span class="mf">.88946</span><span class="p">,</span><span class="mf">0.8972</span><span class="p">,</span><span class="mf">0.60485</span><span class="p">],[</span><span class="mf">.88947</span><span class="p">,</span><span class="mf">0.89994</span><span class="p">,</span><span class="mf">0.61409</span><span class="p">],[</span><span class="mf">.88921</span><span class="p">,</span><span class="mf">0.9025</span><span class="p">,</span><span class="mf">0.62319</span><span class="p">],[</span><span class="mf">.88867</span><span class="p">,</span><span class="mf">0.90488</span><span class="p">,</span><span class="mf">0.6321</span><span class="p">],[</span><span class="mf">.88785</span><span class="p">,</span><span class="mf">0.90709</span><span class="p">,</span><span class="mf">0.64085</span><span class="p">],[</span><span class="mf">.88674</span><span class="p">,</span><span class="mf">0.90914</span><span class="p">,</span><span class="mf">0.64945</span><span class="p">],[</span><span class="mf">.88534</span><span class="p">,</span><span class="mf">0.91104</span><span class="p">,</span><span class="mf">0.65787</span><span class="p">],[</span><span class="mf">.88364</span><span class="p">,</span><span class="mf">0.91279</span><span class="p">,</span><span class="mf">0.66612</span><span class="p">],[</span><span class="mf">.88165</span><span class="p">,</span><span class="mf">0.9144</span><span class="p">,</span><span class="mf">0.67421</span><span class="p">],[</span><span class="mf">.87934</span><span class="p">,</span><span class="mf">0.91587</span><span class="p">,</span><span class="mf">0.68212</span><span class="p">],[</span><span class="mf">.87673</span><span class="p">,</span><span class="mf">0.91722</span><span class="p">,</span><span class="mf">0.68988</span><span class="p">],[</span><span class="mf">.87381</span><span class="p">,</span><span class="mf">0.91842</span><span class="p">,</span><span class="mf">0.69745</span><span class="p">],[</span><span class="mf">.87058</span><span class="p">,</span><span class="mf">0.9195</span><span class="p">,</span><span class="mf">0.70485</span><span class="p">],[</span><span class="mf">.86703</span><span class="p">,</span><span class="mf">0.92046</span><span class="p">,</span><span class="mf">0.71207</span><span class="p">],[</span><span class="mf">.86316</span><span class="p">,</span><span class="mf">0.92129</span><span class="p">,</span><span class="mf">0.71912</span><span class="p">],[</span><span class="mf">.85897</span><span class="p">,</span><span class="mf">0.92201</span><span class="p">,</span><span class="mf">0.72598</span><span class="p">],[</span><span class="mf">.85447</span><span class="p">,</span><span class="mf">0.9226</span><span class="p">,</span><span class="mf">0.73266</span><span class="p">],[</span><span class="mf">.84965</span><span class="p">,</span><span class="mf">0.92307</span><span class="p">,</span><span class="mf">0.73915</span><span class="p">],[</span><span class="mf">.84452</span><span class="p">,</span><span class="mf">0.92342</span><span class="p">,</span><span class="mf">0.74544</span><span class="p">],[</span><span class="mf">.83906</span><span class="p">,</span><span class="mf">0.92365</span><span class="p">,</span><span class="mf">0.75155</span><span class="p">],[</span><span class="mf">.8333</span><span class="p">,</span><span class="mf">0.92375</span><span class="p">,</span><span class="mf">0.75746</span><span class="p">],[</span><span class="mf">.82723</span><span class="p">,</span><span class="mf">0.92373</span><span class="p">,</span><span class="mf">0.76318</span><span class="p">],[</span><span class="mf">.82086</span><span class="p">,</span><span class="mf">0.92358</span><span class="p">,</span><span class="mf">0.7687</span><span class="p">],[</span><span class="mf">.81418</span><span class="p">,</span><span class="mf">0.9233</span><span class="p">,</span><span class="mf">0.77403</span><span class="p">],[</span><span class="mf">.80722</span><span class="p">,</span><span class="mf">0.92289</span><span class="p">,</span><span class="mf">0.77916</span><span class="p">],[</span><span class="mf">.79997</span><span class="p">,</span><span class="mf">0.92234</span><span class="p">,</span><span class="mf">0.7841</span><span class="p">],[</span><span class="mf">.79243</span><span class="p">,</span><span class="mf">0.92166</span><span class="p">,</span><span class="mf">0.78883</span><span class="p">],[</span><span class="mf">.78462</span><span class="p">,</span><span class="mf">0.92082</span><span class="p">,</span><span class="mf">0.79337</span><span class="p">],[</span><span class="mf">.77654</span><span class="p">,</span><span class="mf">0.91986</span><span class="p">,</span><span class="mf">0.79771</span><span class="p">],[</span><span class="mf">.7682</span><span class="p">,</span><span class="mf">0.91873</span><span class="p">,</span><span class="mf">0.80185</span><span class="p">],[</span><span class="mf">.7596</span><span class="p">,</span><span class="mf">0.91747</span><span class="p">,</span><span class="mf">0.80581</span><span class="p">],[</span><span class="mf">.75077</span><span class="p">,</span><span class="mf">0.91603</span><span class="p">,</span><span class="mf">0.80957</span><span class="p">],[</span><span class="mf">.74169</span><span class="p">,</span><span class="mf">0.91444</span><span class="p">,</span><span class="mf">0.81313</span><span class="p">],[</span><span class="mf">.7324</span><span class="p">,</span><span class="mf">0.91268</span><span class="p">,</span><span class="mf">0.81651</span><span class="p">],[</span><span class="mf">.72287</span><span class="p">,</span><span class="mf">0.91075</span><span class="p">,</span><span class="mf">0.8197</span><span class="p">],[</span><span class="mf">.71314</span><span class="p">,</span><span class="mf">0.90865</span><span class="p">,</span><span class="mf">0.8227</span><span class="p">],[</span><span class="mf">.70322</span><span class="p">,</span><span class="mf">0.90636</span><span class="p">,</span><span class="mf">0.82551</span><span class="p">],[</span><span class="mf">.69311</span><span class="p">,</span><span class="mf">0.90389</span><span class="p">,</span><span class="mf">0.82814</span><span class="p">],[</span><span class="mf">.68283</span><span class="p">,</span><span class="mf">0.90124</span><span class="p">,</span><span class="mf">0.83059</span><span class="p">],[</span><span class="mf">.67239</span><span class="p">,</span><span class="mf">0.89839</span><span class="p">,</span><span class="mf">0.83284</span><span class="p">],[</span><span class="mf">.6618</span><span class="p">,</span><span class="mf">0.89535</span><span class="p">,</span><span class="mf">0.83492</span><span class="p">],[</span><span class="mf">.65107</span><span class="p">,</span><span class="mf">0.89211</span><span class="p">,</span><span class="mf">0.83682</span><span class="p">],[</span><span class="mf">.64024</span><span class="p">,</span><span class="mf">0.88868</span><span class="p">,</span><span class="mf">0.83853</span><span class="p">],[</span><span class="mf">.6293</span><span class="p">,</span><span class="mf">0.88504</span><span class="p">,</span><span class="mf">0.84006</span><span class="p">],[</span><span class="mf">.61828</span><span class="p">,</span><span class="mf">0.8812</span><span class="p">,</span><span class="mf">0.84141</span><span class="p">],[</span><span class="mf">.60721</span><span class="p">,</span><span class="mf">0.87716</span><span class="p">,</span><span class="mf">0.84258</span><span class="p">],[</span><span class="mf">.59608</span><span class="p">,</span><span class="mf">0.87292</span><span class="p">,</span><span class="mf">0.84357</span><span class="p">],[</span><span class="mf">.58494</span><span class="p">,</span><span class="mf">0.86849</span><span class="p">,</span><span class="mf">0.84438</span><span class="p">],[</span><span class="mf">.57379</span><span class="p">,</span><span class="mf">0.86386</span><span class="p">,</span><span class="mf">0.84502</span><span class="p">],[</span><span class="mf">.56267</span><span class="p">,</span><span class="mf">0.85903</span><span class="p">,</span><span class="mf">0.84548</span><span class="p">],[</span><span class="mf">.55159</span><span class="p">,</span><span class="mf">0.85402</span><span class="p">,</span><span class="mf">0.84576</span><span class="p">],[</span><span class="mf">.54058</span><span class="p">,</span><span class="mf">0.84884</span><span class="p">,</span><span class="mf">0.84588</span><span class="p">],[</span><span class="mf">.52966</span><span class="p">,</span><span class="mf">0.84347</span><span class="p">,</span><span class="mf">0.84582</span><span class="p">],[</span><span class="mf">.51886</span><span class="p">,</span><span class="mf">0.83795</span><span class="p">,</span><span class="mf">0.8456</span><span class="p">],[</span><span class="mf">.50819</span><span class="p">,</span><span class="mf">0.83227</span><span class="p">,</span><span class="mf">0.84522</span><span class="p">],[</span><span class="mf">.49767</span><span class="p">,</span><span class="mf">0.82643</span><span class="p">,</span><span class="mf">0.84467</span><span class="p">],[</span><span class="mf">.48733</span><span class="p">,</span><span class="mf">0.82046</span><span class="p">,</span><span class="mf">0.84397</span><span class="p">],[</span><span class="mf">.47718</span><span class="p">,</span><span class="mf">0.81436</span><span class="p">,</span><span class="mf">0.84312</span><span class="p">],[</span><span class="mf">.46725</span><span class="p">,</span><span class="mf">0.80814</span><span class="p">,</span><span class="mf">0.84213</span><span class="p">],[</span><span class="mf">.45755</span><span class="p">,</span><span class="mf">0.8018</span><span class="p">,</span><span class="mf">0.84099</span><span class="p">],[</span><span class="mf">.44809</span><span class="p">,</span><span class="mf">0.79537</span><span class="p">,</span><span class="mf">0.83973</span><span class="p">],[</span><span class="mf">.43889</span><span class="p">,</span><span class="mf">0.78885</span><span class="p">,</span><span class="mf">0.83833</span><span class="p">],[</span><span class="mf">.42997</span><span class="p">,</span><span class="mf">0.78225</span><span class="p">,</span><span class="mf">0.83681</span><span class="p">],[</span><span class="mf">.42131</span><span class="p">,</span><span class="mf">0.77557</span><span class="p">,</span><span class="mf">0.83517</span><span class="p">],[</span><span class="mf">.41296</span><span class="p">,</span><span class="mf">0.76883</span><span class="p">,</span><span class="mf">0.83343</span><span class="p">],[</span><span class="mf">.40486</span><span class="p">,</span><span class="mf">0.76204</span><span class="p">,</span><span class="mf">0.83159</span><span class="p">],[</span><span class="mf">.39707</span><span class="p">,</span><span class="mf">0.75521</span><span class="p">,</span><span class="mf">0.82964</span><span class="p">],[</span><span class="mf">.38957</span><span class="p">,</span><span class="mf">0.74833</span><span class="p">,</span><span class="mf">0.82761</span><span class="p">],[</span><span class="mf">.38235</span><span class="p">,</span><span class="mf">0.74142</span><span class="p">,</span><span class="mf">0.82549</span><span class="p">],[</span><span class="mf">.37542</span><span class="p">,</span><span class="mf">0.7345</span><span class="p">,</span><span class="mf">0.8233</span><span class="p">],[</span><span class="mf">.36877</span><span class="p">,</span><span class="mf">0.72754</span><span class="p">,</span><span class="mf">0.82104</span><span class="p">],[</span><span class="mf">.36238</span><span class="p">,</span><span class="mf">0.72058</span><span class="p">,</span><span class="mf">0.8187</span><span class="p">],[</span><span class="mf">.35627</span><span class="p">,</span><span class="mf">0.71361</span><span class="p">,</span><span class="mf">0.81632</span><span class="p">],[</span><span class="mf">.3504</span><span class="p">,</span><span class="mf">0.70664</span><span class="p">,</span><span class="mf">0.81387</span><span class="p">],[</span><span class="mf">.34477</span><span class="p">,</span><span class="mf">0.69966</span><span class="p">,</span><span class="mf">0.81138</span><span class="p">],[</span><span class="mf">.33939</span><span class="p">,</span><span class="mf">0.69269</span><span class="p">,</span><span class="mf">0.80884</span><span class="p">],[</span><span class="mf">.33422</span><span class="p">,</span><span class="mf">0.68572</span><span class="p">,</span><span class="mf">0.80626</span><span class="p">],[</span><span class="mf">.32926</span><span class="p">,</span><span class="mf">0.67875</span><span class="p">,</span><span class="mf">0.80364</span><span class="p">],[</span><span class="mf">.32448</span><span class="p">,</span><span class="mf">0.67181</span><span class="p">,</span><span class="mf">0.801</span><span class="p">],[</span><span class="mf">.31992</span><span class="p">,</span><span class="mf">0.66486</span><span class="p">,</span><span class="mf">0.79832</span><span class="p">],[</span><span class="mf">.31551</span><span class="p">,</span><span class="mf">0.65795</span><span class="p">,</span><span class="mf">0.79562</span><span class="p">],[</span><span class="mf">.31127</span><span class="p">,</span><span class="mf">0.65104</span><span class="p">,</span><span class="mf">0.7929</span><span class="p">],[</span><span class="mf">.30718</span><span class="p">,</span><span class="mf">0.64414</span><span class="p">,</span><span class="mf">0.79015</span><span class="p">],[</span><span class="mf">.30322</span><span class="p">,</span><span class="mf">0.63727</span><span class="p">,</span><span class="mf">0.78739</span><span class="p">],[</span><span class="mf">.29942</span><span class="p">,</span><span class="mf">0.63042</span><span class="p">,</span><span class="mf">0.78462</span><span class="p">],[</span><span class="mf">.29571</span><span class="p">,</span><span class="mf">0.62358</span><span class="p">,</span><span class="mf">0.78184</span><span class="p">],[</span><span class="mf">.29213</span><span class="p">,</span><span class="mf">0.61676</span><span class="p">,</span><span class="mf">0.77904</span><span class="p">],[</span><span class="mf">.28864</span><span class="p">,</span><span class="mf">0.60995</span><span class="p">,</span><span class="mf">0.77624</span><span class="p">],[</span><span class="mf">.28523</span><span class="p">,</span><span class="mf">0.60318</span><span class="p">,</span><span class="mf">0.77343</span><span class="p">],[</span><span class="mf">.28193</span><span class="p">,</span><span class="mf">0.59642</span><span class="p">,</span><span class="mf">0.77063</span><span class="p">],[</span><span class="mf">.2787</span><span class="p">,</span><span class="mf">0.58967</span><span class="p">,</span><span class="mf">0.76781</span><span class="p">],[</span><span class="mf">.27554</span><span class="p">,</span><span class="mf">0.58296</span><span class="p">,</span><span class="mf">0.765</span><span class="p">],[</span><span class="mf">.27241</span><span class="p">,</span><span class="mf">0.57628</span><span class="p">,</span><span class="mf">0.76218</span><span class="p">],[</span><span class="mf">.26939</span><span class="p">,</span><span class="mf">0.56959</span><span class="p">,</span><span class="mf">0.75937</span><span class="p">],[</span><span class="mf">.26638</span><span class="p">,</span><span class="mf">0.56295</span><span class="p">,</span><span class="mf">0.75656</span><span class="p">],[</span><span class="mf">.26345</span><span class="p">,</span><span class="mf">0.5563</span><span class="p">,</span><span class="mf">0.75375</span><span class="p">],[</span><span class="mf">.26053</span><span class="p">,</span><span class="mf">0.5497</span><span class="p">,</span><span class="mf">0.75095</span><span class="p">],[</span><span class="mf">.25766</span><span class="p">,</span><span class="mf">0.54311</span><span class="p">,</span><span class="mf">0.74814</span><span class="p">],[</span><span class="mf">.25486</span><span class="p">,</span><span class="mf">0.53655</span><span class="p">,</span><span class="mf">0.74534</span><span class="p">],[</span><span class="mf">.25205</span><span class="p">,</span><span class="mf">0.53</span><span class="p">,</span><span class="mf">0.74255</span><span class="p">],[</span><span class="mf">.24928</span><span class="p">,</span><span class="mf">0.52347</span><span class="p">,</span><span class="mf">0.73977</span><span class="p">],[</span><span class="mf">.24654</span><span class="p">,</span><span class="mf">0.51697</span><span class="p">,</span><span class="mf">0.73698</span><span class="p">],[</span><span class="mf">.24382</span><span class="p">,</span><span class="mf">0.51048</span><span class="p">,</span><span class="mf">0.73421</span><span class="p">],[</span><span class="mf">.24114</span><span class="p">,</span><span class="mf">0.50402</span><span class="p">,</span><span class="mf">0.73143</span><span class="p">],[</span><span class="mf">.23846</span><span class="p">,</span><span class="mf">0.49758</span><span class="p">,</span><span class="mf">0.72867</span><span class="p">],[</span><span class="mf">.23583</span><span class="p">,</span><span class="mf">0.49117</span><span class="p">,</span><span class="mf">0.72592</span><span class="p">],[</span><span class="mf">.23317</span><span class="p">,</span><span class="mf">0.48475</span><span class="p">,</span><span class="mf">0.72317</span><span class="p">],[</span><span class="mf">.23056</span><span class="p">,</span><span class="mf">0.47838</span><span class="p">,</span><span class="mf">0.72043</span><span class="p">],[</span><span class="mf">.22798</span><span class="p">,</span><span class="mf">0.47202</span><span class="p">,</span><span class="mf">0.7177</span><span class="p">],[</span><span class="mf">.22538</span><span class="p">,</span><span class="mf">0.46567</span><span class="p">,</span><span class="mf">0.71496</span><span class="p">],[</span><span class="mf">.22282</span><span class="p">,</span><span class="mf">0.45936</span><span class="p">,</span><span class="mf">0.71224</span><span class="p">],[</span><span class="mf">.22026</span><span class="p">,</span><span class="mf">0.45306</span><span class="p">,</span><span class="mf">0.70953</span><span class="p">],[</span><span class="mf">.2177</span><span class="p">,</span><span class="mf">0.44678</span><span class="p">,</span><span class="mf">0.70682</span><span class="p">],[</span><span class="mf">.21514</span><span class="p">,</span><span class="mf">0.44051</span><span class="p">,</span><span class="mf">0.70412</span><span class="p">],[</span><span class="mf">.21262</span><span class="p">,</span><span class="mf">0.43427</span><span class="p">,</span><span class="mf">0.70142</span><span class="p">],[</span><span class="mf">.21009</span><span class="p">,</span><span class="mf">0.42806</span><span class="p">,</span><span class="mf">0.69874</span><span class="p">],[</span><span class="mf">.20758</span><span class="p">,</span><span class="mf">0.42184</span><span class="p">,</span><span class="mf">0.69606</span><span class="p">],[</span><span class="mf">.20507</span><span class="p">,</span><span class="mf">0.41566</span><span class="p">,</span><span class="mf">0.69339</span><span class="p">],[</span><span class="mf">.20256</span><span class="p">,</span><span class="mf">0.4095</span><span class="p">,</span><span class="mf">0.69071</span><span class="p">],[</span><span class="mf">.20005</span><span class="p">,</span><span class="mf">0.40335</span><span class="p">,</span><span class="mf">0.68806</span><span class="p">],[</span><span class="mf">.19757</span><span class="p">,</span><span class="mf">0.3972</span><span class="p">,</span><span class="mf">0.6854</span><span class="p">],[</span><span class="mf">.19509</span><span class="p">,</span><span class="mf">0.3911</span><span class="p">,</span><span class="mf">0.68275</span><span class="p">],[</span><span class="mf">.19259</span><span class="p">,</span><span class="mf">0.38498</span><span class="p">,</span><span class="mf">0.6801</span><span class="p">],[</span><span class="mf">.1901</span><span class="p">,</span><span class="mf">0.3789</span><span class="p">,</span><span class="mf">0.67748</span><span class="p">],[</span><span class="mf">.18765</span><span class="p">,</span><span class="mf">0.37283</span><span class="p">,</span><span class="mf">0.67484</span><span class="p">],[</span><span class="mf">.18515</span><span class="p">,</span><span class="mf">0.36678</span><span class="p">,</span><span class="mf">0.67222</span><span class="p">],[</span><span class="mf">.18262</span><span class="p">,</span><span class="mf">0.36073</span><span class="p">,</span><span class="mf">0.66959</span><span class="p">],[</span><span class="mf">.18013</span><span class="p">,</span><span class="mf">0.35472</span><span class="p">,</span><span class="mf">0.66697</span><span class="p">],[</span><span class="mf">.17766</span><span class="p">,</span><span class="mf">0.3487</span><span class="p">,</span><span class="mf">0.66436</span><span class="p">],[</span><span class="mf">.17513</span><span class="p">,</span><span class="mf">0.34271</span><span class="p">,</span><span class="mf">0.66176</span><span class="p">],[</span><span class="mf">.17259</span><span class="p">,</span><span class="mf">0.33671</span><span class="p">,</span><span class="mf">0.65915</span><span class="p">],[</span><span class="mf">.17007</span><span class="p">,</span><span class="mf">0.33072</span><span class="p">,</span><span class="mf">0.65656</span><span class="p">],[</span><span class="mf">.16752</span><span class="p">,</span><span class="mf">0.32475</span><span class="p">,</span><span class="mf">0.65396</span><span class="p">],[</span><span class="mf">.16494</span><span class="p">,</span><span class="mf">0.3188</span><span class="p">,</span><span class="mf">0.65137</span><span class="p">],[</span><span class="mf">.16238</span><span class="p">,</span><span class="mf">0.31285</span><span class="p">,</span><span class="mf">0.64878</span><span class="p">],[</span><span class="mf">.15974</span><span class="p">,</span><span class="mf">0.30691</span><span class="p">,</span><span class="mf">0.64619</span><span class="p">],[</span><span class="mf">.15712</span><span class="p">,</span><span class="mf">0.30097</span><span class="p">,</span><span class="mf">0.64361</span><span class="p">],[</span><span class="mf">.15446</span><span class="p">,</span><span class="mf">0.29504</span><span class="p">,</span><span class="mf">0.64103</span><span class="p">],[</span><span class="mf">.15176</span><span class="p">,</span><span class="mf">0.28914</span><span class="p">,</span><span class="mf">0.63846</span><span class="p">],[</span><span class="mf">.14904</span><span class="p">,</span><span class="mf">0.28322</span><span class="p">,</span><span class="mf">0.63589</span><span class="p">],[</span><span class="mf">.14627</span><span class="p">,</span><span class="mf">0.2773</span><span class="p">,</span><span class="mf">0.63331</span><span class="p">],[</span><span class="mf">.14346</span><span class="p">,</span><span class="mf">0.27138</span><span class="p">,</span><span class="mf">0.63075</span><span class="p">],[</span><span class="mf">.1406</span><span class="p">,</span><span class="mf">0.26547</span><span class="p">,</span><span class="mf">0.62818</span><span class="p">],[</span><span class="mf">.13769</span><span class="p">,</span><span class="mf">0.25957</span><span class="p">,</span><span class="mf">0.62561</span><span class="p">],[</span><span class="mf">.1347</span><span class="p">,</span><span class="mf">0.25365</span><span class="p">,</span><span class="mf">0.62305</span><span class="p">],[</span><span class="mf">.13163</span><span class="p">,</span><span class="mf">0.24774</span><span class="p">,</span><span class="mf">0.62049</span><span class="p">],[</span><span class="mf">.12849</span><span class="p">,</span><span class="mf">0.24182</span><span class="p">,</span><span class="mf">0.61792</span><span class="p">],[</span><span class="mf">.12528</span><span class="p">,</span><span class="mf">0.2359</span><span class="p">,</span><span class="mf">0.61535</span><span class="p">],[</span><span class="mf">.12194</span><span class="p">,</span><span class="mf">0.22993</span><span class="p">,</span><span class="mf">0.61279</span><span class="p">],[</span><span class="mf">.11859</span><span class="p">,</span><span class="mf">0.22399</span><span class="p">,</span><span class="mf">0.61023</span><span class="p">],[</span><span class="mf">.11502</span><span class="p">,</span><span class="mf">0.21805</span><span class="p">,</span><span class="mf">0.60768</span><span class="p">],[</span><span class="mf">.11142</span><span class="p">,</span><span class="mf">0.21209</span><span class="p">,</span><span class="mf">0.60511</span><span class="p">],[</span><span class="mf">.10761</span><span class="p">,</span><span class="mf">0.20611</span><span class="p">,</span><span class="mf">0.60255</span><span class="p">],[</span><span class="mf">.1037</span><span class="p">,</span><span class="mf">0.20006</span><span class="p">,</span><span class="mf">0.59999</span><span class="p">]]</span>

<span class="n">roma</span>   <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">&#39;roma&#39;</span><span class="p">,</span><span class="n">roma_cm_data</span><span class="p">)</span>
<span class="n">roma_r</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">&#39;roma_r&#39;</span><span class="p">,</span><span class="n">roma_cm_data</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;roma&#39;</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">register_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;roma&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">roma</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;roma_r&#39;</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">register_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;roma_r&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">roma_r</span><span class="p">)</span>

    
<span class="c1">############################################################</span>
<span class="c1">############################################################</span>
<span class="c1">############################################################</span>
<span class="c1">############################################################</span>

<span class="kn">from</span> <span class="nn">.util</span> <span class="kn">import</span> <span class="n">is_in_hull</span>
<div class="viewcode-block" id="tracking_match_plot"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.tracking_match_plot">[docs]</a><span class="k">def</span> <span class="nf">tracking_match_plot</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">centroids</span><span class="p">,</span> 
    <span class="n">paths</span><span class="p">,</span>
    <span class="n">fieldcolor</span><span class="o">=</span><span class="n">MAUVE</span>
    <span class="p">):</span>
    <span class="n">ok</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="n">where</span><span class="p">(</span>
        <span class="n">is_in_hull</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">arena</span><span class="o">.</span><span class="n">hull</span><span class="p">)</span>
    <span class="p">)[</span><span class="mi">0</span><span class="p">]}</span>
    <span class="n">ok</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ok</span><span class="p">))</span>
    <span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">centroids</span><span class="p">[:,</span><span class="n">ok</span><span class="p">],</span><span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,)</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="n">fieldcolor</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">centroids</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ok</span><span class="p">:</span> <span class="k">continue</span>
        <span class="n">tx</span><span class="p">,</span><span class="n">ty</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">text</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">fieldcolor</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
        <span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">c2p</span><span class="p">(</span><span class="n">nanmean</span><span class="p">(</span><span class="n">p2c</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
        <span class="c1">#scatter(*center,marker=&#39;x&#39;,lw=.5,color=&#39;r&#39;)</span>
        <span class="n">tx</span><span class="p">,</span><span class="n">ty</span> <span class="o">=</span> <span class="n">center</span>
        <span class="n">text</span><span class="p">(</span><span class="n">tx</span><span class="o">+</span><span class="n">px2x</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ty</span><span class="o">+</span><span class="n">px2y</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">arena</span><span class="o">.</span><span class="n">perimeter</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">noxyaxes</span><span class="p">()</span>
    <span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">force_aspect</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="shiftplot"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.shiftplot">[docs]</a><span class="k">def</span> <span class="nf">shiftplot</span><span class="p">(</span>
    <span class="n">z1</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">zscore</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">draw_ellipse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">draw_lines</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">line_color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span>
    <span class="n">line_width</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
    <span class="n">s</span>  <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;lw&#39;</span><span class="p">:</span><span class="mf">.6</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">}</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ellipses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,(</span><span class="n">si</span><span class="p">,</span><span class="n">za</span><span class="p">,</span><span class="n">zb</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">si</span><span class="p">)):</span> <span class="k">continue</span>
        <span class="k">if</span> <span class="n">centers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">z0</span> <span class="o">=</span> <span class="p">(</span><span class="n">za</span><span class="o">+</span><span class="n">zb</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">z0</span> <span class="o">=</span> <span class="n">centers</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">zscore</span><span class="p">:</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">get_whitener</span><span class="p">(</span><span class="n">si</span><span class="p">)</span><span class="o">@</span><span class="p">(</span><span class="n">zb</span><span class="o">-</span><span class="n">za</span><span class="p">)</span><span class="o">*</span><span class="n">scale</span>
            <span class="n">cxy</span> <span class="o">=</span> <span class="n">covariance_crosshairs</span><span class="p">(</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">draw_cross</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">*</span><span class="n">scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">zb</span><span class="o">-</span><span class="n">za</span>
            <span class="n">cxy</span> <span class="o">=</span> <span class="n">covariance_crosshairs</span><span class="p">(</span><span class="n">si</span><span class="p">,</span><span class="n">draw_cross</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">cxy</span> <span class="o">+=</span> <span class="n">z0</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
        
        <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">float32</span><span class="p">([</span><span class="n">z0</span><span class="o">-</span><span class="n">delta</span><span class="p">,</span><span class="n">z0</span><span class="o">+</span><span class="n">delta</span><span class="p">]))</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">NaN</span><span class="p">,</span><span class="n">NaN</span><span class="p">])</span>
        <span class="n">ellipses</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">cxy</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">ellipses</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">NaN</span><span class="p">,</span><span class="n">NaN</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">draw_lines</span><span class="p">:</span>
        <span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">float32</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">line_color</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="n">line_width</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">draw_ellipse</span><span class="p">:</span>
        <span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">float32</span><span class="p">(</span><span class="n">ellipses</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">force_aspect</span><span class="p">()</span>
    <span class="n">noxyaxes</span><span class="p">()</span></div>

<span class="kn">import</span> <span class="nn">lgcpspatial</span>
<div class="viewcode-block" id="colored_shift_density_images"><a class="viewcode-back" href="../../lgcpspatial.plot.html#lgcpspatial.plot.colored_shift_density_images">[docs]</a><span class="k">def</span> <span class="nf">colored_shift_density_images</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> 
    <span class="n">NSEW_densities</span><span class="p">,</span> 
    <span class="n">pct</span>  <span class="o">=</span> <span class="mf">99.9</span> <span class="c1"># Saturate pixels above this</span>
    <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Prepare colored (North - South) and (East - West)</span>
<span class="sd">    peak density shift images.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data: lgcpspatial.loaddata.Dataset</span>
<span class="sd">        Prepared dataset object.</span>
<span class="sd">    NSEW_densities: list</span>
<span class="sd">        Length 4 list of [N,S,E,W] results, each containing</span>
<span class="sd">        a ``(L*resolution)×(L*resolution)`` smoothed </span>
<span class="sd">        peak-density map.</span>
<span class="sd">    </span>
<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    pct: float ∈(0,100); default 99.9</span>
<span class="sd">        Percentile of maximum saturation.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    RGBNS:</span>
<span class="sd">        Rendered RGB values for NS plot</span>
<span class="sd">    RGBEW:</span>
<span class="sd">        Rendered RGB values for EW plot</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># Unpack reference result</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">L</span>
    <span class="n">N</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">W</span> <span class="o">=</span> <span class="n">NSEW_densities</span>
    
    <span class="n">LL</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">resolution</span> <span class="o">=</span> <span class="n">LL</span><span class="o">//</span><span class="n">L</span>
    
    <span class="n">mask</span> <span class="o">=</span> <span class="n">lgcpspatial</span><span class="o">.</span><span class="n">loaddata</span><span class="o">.</span><span class="n">Arena</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">px</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">py</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">resolution</span><span class="p">)</span><span class="o">.</span><span class="n">mask</span>

    <span class="n">colors</span>  <span class="o">=</span> <span class="mf">1.</span><span class="o">-</span><span class="n">array</span><span class="p">([</span><span class="n">cE</span><span class="p">,</span><span class="n">cW</span><span class="p">])</span>
    <span class="n">RGBEW</span>   <span class="o">=</span> <span class="mf">1.</span><span class="o">-</span><span class="n">clip</span><span class="p">(</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;dc,dxy-&gt;xyc&#39;</span><span class="p">,</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">array</span><span class="p">([</span>
            <span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">pct</span><span class="p">)),</span>
            <span class="p">(</span><span class="n">W</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">W</span><span class="p">,</span><span class="n">pct</span><span class="p">))])),</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">RGBEW</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">,</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">colors</span>  <span class="o">=</span> <span class="mf">1.</span><span class="o">-</span><span class="n">array</span><span class="p">([</span><span class="n">cN</span><span class="p">,</span><span class="n">cS</span><span class="p">])</span>
    <span class="n">RGBNS</span>   <span class="o">=</span> <span class="mf">1.</span><span class="o">-</span><span class="n">clip</span><span class="p">(</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;dc,dxy-&gt;xyc&#39;</span><span class="p">,</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">array</span><span class="p">([</span>
            <span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">pct</span><span class="p">)),</span>
            <span class="p">(</span><span class="n">S</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">pct</span><span class="p">))])),</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">RGBNS</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">,</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">RGBNS</span><span class="p">,</span> <span class="n">RGBEW</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020–2022, M. E. Rule; P. Chaudhuri-Vayalambrone.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>